{"question": "Close price and split factors for ON between 2025-05-13 and 2025-06-11.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ON' and p.date between '2025-05-13' and '2025-06-11' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Industrials on 2024-07-15.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2024-07-15';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Energy that traded on 2025-03-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-03-27' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for ROL in week 2024-04-22 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ROL' and week='2024-04-22 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Communication Services that traded on 2024-06-24.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-06-24' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Average close for EMN from 2023-11-22 to 2023-12-19.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EMN' and date between '2023-11-22' and '2023-12-19';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for CINF.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='CINF' order by date;", "intent": "dividend_yield"}
{"question": "Close price and dividend cash events for ITW between 2024-04-15 and 2024-05-08.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ITW' and p.date between '2024-04-15' and '2024-05-08' order by p.date;", "intent": "join_dividends"}
{"question": "Company profile for ARE including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='ARE';", "intent": "profile"}
{"question": "Company profile for CTSH including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CTSH';", "intent": "profile"}
{"question": "Latest close and volume for BEN.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='BEN') select date, close, volume from core.prices_daily, mx where ticker='BEN' and date=mx.md;", "intent": "latest_point"}
{"question": "Company profile for FIS including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='FIS';", "intent": "profile"}
{"question": "Tickers in sector Healthcare that traded on 2024-03-20.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-20' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Average close for KO from 2025-04-04 to 2025-05-29.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='KO' and date between '2025-04-04' and '2025-05-29';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for MET.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='MET' order by date;", "intent": "dividend_yield"}
{"question": "Average close for CSGP from 2025-07-16 to 2025-08-19.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CSGP' and date between '2025-07-16' and '2025-08-19';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for MO in 2025-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MO' and month='2025-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "7-day and 30-day returns for CMG.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='CMG' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Tickers in sector Basic Materials that traded on 2024-06-17.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-06-17' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for UNH between 2025-05-21 and 2025-06-03.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='UNH' and p.date between '2025-05-21' and '2025-06-03' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for LVS between 2024-10-01 and 2024-11-21.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LVS' and p.date between '2024-10-01' and '2024-11-21' order by p.date;", "intent": "join_dividends"}
{"question": "Dividend yield TTM time series for PPL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PPL' order by date;", "intent": "dividend_yield"}
{"question": "Close price and dividend cash events for APH between 2023-11-13 and 2024-02-05.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='APH' and p.date between '2023-11-13' and '2024-02-05' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for MPWR from 2024-06-17 to 2024-08-07.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='MPWR' and date between '2024-06-17' and '2024-08-07';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Communication Services on 2024-11-29.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-11-29';", "intent": "sector_aggregate"}
{"question": "Corporate actions for MCK ordered by date.", "sql": "select * from views.corporate_actions where ticker='MCK' order by event_date;", "intent": "corporate_actions"}
{"question": "Latest close and volume for NTRS.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='NTRS') select date, close, volume from core.prices_daily, mx where ticker='NTRS' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close and total volume for sector Industrials on 2025-08-15.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2025-08-15';", "intent": "sector_aggregate"}
{"question": "Year-to-date cumulative return for TROW.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='TROW' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Company profile for DLR including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='DLR';", "intent": "profile"}
{"question": "Weekly OHLCV for AMGN in week 2025-07-07 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AMGN' and week='2025-07-07 00:00:00';", "intent": "resample_weekly"}
{"question": "Top 10 gainers by daily return on 2024-05-07.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-05-07' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and split factors for TPR between 2024-08-05 and 2024-09-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='TPR' and p.date between '2024-08-05' and '2024-09-12' order by p.date;", "intent": "join_splits"}
{"question": "Average close for XOM from 2024-06-10 to 2024-08-02.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='XOM' and date between '2024-06-10' and '2024-08-02';", "intent": "avg_between_dates"}
{"question": "Close price and split factors for A between 2024-04-23 and 2024-05-03.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='A' and p.date between '2024-04-23' and '2024-05-03' order by p.date;", "intent": "join_splits"}
{"question": "Show OHLCV for ZBH on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='ZBH') select p.* from core.prices_daily p, d where p.ticker='ZBH' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Split-adjusted close series for MTB.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MTB' order by date;", "intent": "adjusted_price"}
{"question": "Average close for VRSN from 2025-03-31 to 2025-05-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='VRSN' and date between '2025-03-31' and '2025-05-21';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Communication Services on 2024-02-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-02-12';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Technology on 2025-05-13.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2025-05-13';", "intent": "sector_aggregate"}
{"question": "Average close for FAST from 2024-01-23 to 2024-02-05.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='FAST' and date between '2024-01-23' and '2024-02-05';", "intent": "avg_between_dates"}
{"question": "Close price and split factors for TER between 2025-04-28 and 2025-05-14.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='TER' and p.date between '2025-04-28' and '2025-05-14' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for BSX in week 2024-06-24 00:00:00.", "sql": "select * from views.prices_weekly where ticker='BSX' and week='2024-06-24 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for UHS on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='UHS') select p.* from core.prices_daily p, d where p.ticker='UHS' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Corporate actions for UDR ordered by date.", "sql": "select * from views.corporate_actions where ticker='UDR' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and split factors for FANG between 2024-03-04 and 2024-05-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='FANG' and p.date between '2024-03-04' and '2024-05-16' order by p.date;", "intent": "join_splits"}
{"question": "Latest close and volume for CAG.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='CAG') select date, close, volume from core.prices_daily, mx where ticker='CAG' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for ADM in week 2024-01-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ADM' and week='2024-01-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for TRGP from 2024-04-03 to 2024-05-06.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='TRGP' and date between '2024-04-03' and '2024-05-06';", "intent": "avg_between_dates"}
{"question": "Close price and split factors for KR between 2024-08-14 and 2024-09-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KR' and p.date between '2024-08-14' and '2024-09-16' order by p.date;", "intent": "join_splits"}
{"question": "Average close for LKQ from 2025-08-19 to 2025-10-14.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='LKQ' and date between '2025-08-19' and '2025-10-14';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for VLO.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='VLO' order by date;", "intent": "adjusted_price"}
{"question": "7-day and 30-day returns for ABBV.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='ABBV' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "7-day and 30-day returns for TSN.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='TSN' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and dividend cash events for TXN between 2024-07-19 and 2024-08-26.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='TXN' and p.date between '2024-07-19' and '2024-08-26' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for MKC between 2023-11-09 and 2023-12-26.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MKC' and p.date between '2023-11-09' and '2023-12-26' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-11-05.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-11-05' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for AMT.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AMT') select date, close, volume from core.prices_daily, mx where ticker='AMT' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for CPB from 2025-02-04 to 2025-02-28.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CPB' and date between '2025-02-04' and '2025-02-28';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for ON in week 2025-02-24 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ON' and week='2025-02-24 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for CDW in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CDW' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for AIZ.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='AIZ' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for MOS between 2024-08-28 and 2024-09-10.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MOS' and p.date between '2024-08-28' and '2024-09-10' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for WST between 2024-11-22 and 2024-12-16.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='WST' and p.date between '2024-11-22' and '2024-12-16' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Consumer Defensive on 2024-01-25.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2024-01-25';", "intent": "sector_aggregate"}
{"question": "Show OHLCV for BWA on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='BWA') select p.* from core.prices_daily p, d where p.ticker='BWA' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Weekly OHLCV for ETR in week 2024-07-08 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ETR' and week='2024-07-08 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for DXCM between 2024-11-15 and 2025-02-24.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='DXCM' and p.date between '2024-11-15' and '2025-02-24' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for HSIC between 2024-08-15 and 2024-08-27.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='HSIC' and p.date between '2024-08-15' and '2024-08-27' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for WFC between 2024-07-11 and 2024-08-13.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='WFC' and p.date between '2024-07-11' and '2024-08-13' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for TMO between 2024-07-02 and 2024-08-05.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='TMO' and p.date between '2024-07-02' and '2024-08-05' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for IDXX.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='IDXX') select date, close, volume from core.prices_daily, mx where ticker='IDXX' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for CLX in week 2024-09-16 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CLX' and week='2024-09-16 00:00:00';", "intent": "resample_weekly"}
{"question": "Corporate actions for BXP ordered by date.", "sql": "select * from views.corporate_actions where ticker='BXP' order by event_date;", "intent": "corporate_actions"}
{"question": "Split-adjusted close series for EMN.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='EMN' order by date;", "intent": "adjusted_price"}
{"question": "Show OHLCV for MS on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='MS') select p.* from core.prices_daily p, d where p.ticker='MS' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Latest close and volume for FTV.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='FTV') select date, close, volume from core.prices_daily, mx where ticker='FTV' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for AMP between 2025-02-24 and 2025-04-01.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='AMP' and p.date between '2025-02-24' and '2025-04-01' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Real Estate that traded on 2025-02-07.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-02-07' and t.sector='Real Estate' order by 1;", "intent": "membership"}
{"question": "Was NYSE open on 2024-09-11?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-09-11';", "intent": "calendar_filter"}
{"question": "Weekly OHLCV for TROW in week 2024-08-26 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TROW' and week='2024-08-26 00:00:00';", "intent": "resample_weekly"}
{"question": "Split-adjusted close series for ICE.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ICE' order by date;", "intent": "adjusted_price"}
{"question": "Average close and total volume for sector Consumer Defensive on 2024-07-01.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2024-07-01';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for MLM between 2025-03-25 and 2025-04-02.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MLM' and p.date between '2025-03-25' and '2025-04-02' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for BR between 2024-07-18 and 2024-08-21.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='BR' and p.date between '2024-07-18' and '2024-08-21' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for LNT.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='LNT') select date, close, volume from core.prices_daily, mx where ticker='LNT' and date=mx.md;", "intent": "latest_point"}
{"question": "Show OHLCV for PWR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='PWR') select p.* from core.prices_daily p, d where p.ticker='PWR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for GOOG between 2024-02-08 and 2024-03-08.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='GOOG' and p.date between '2024-02-08' and '2024-03-08' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for RSG between 2025-02-27 and 2025-03-12.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='RSG' and p.date between '2025-02-27' and '2025-03-12' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for MCD between 2023-11-07 and 2023-12-05.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MCD' and p.date between '2023-11-07' and '2023-12-05' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for TSLA in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TSLA' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for NOW in week 2023-10-30 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NOW' and week='2023-10-30 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Energy that traded on 2025-10-01.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-10-01' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Year-to-date cumulative return for DXCM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='DXCM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for VMC between 2025-06-27 and 2025-08-19.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='VMC' and p.date between '2025-06-27' and '2025-08-19' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for AKAM in week 2024-05-27 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AKAM' and week='2024-05-27 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for CMG on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='CMG') select p.* from core.prices_daily p, d where p.ticker='CMG' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Tickers in sector Financial Services that traded on 2023-11-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-11-27' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Average close for CME from 2023-11-15 to 2023-11-27.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CME' and date between '2023-11-15' and '2023-11-27';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for BKNG in 2025-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='BKNG' and month='2025-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for J.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='J') select date, close, volume from core.prices_daily, mx where ticker='J' and date=mx.md;", "intent": "latest_point"}
{"question": "Latest close and volume for AXON.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AXON') select date, close, volume from core.prices_daily, mx where ticker='AXON' and date=mx.md;", "intent": "latest_point"}
{"question": "Split-adjusted close series for K.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='K' order by date;", "intent": "adjusted_price"}
{"question": "Average close for ADBE from 2025-01-03 to 2025-01-22.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ADBE' and date between '2025-01-03' and '2025-01-22';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for NWS in week 2025-09-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NWS' and week='2025-09-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for MOS between 2025-02-25 and 2025-05-13.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MOS' and p.date between '2025-02-25' and '2025-05-13' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for SO between 2025-06-17 and 2025-07-11.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='SO' and p.date between '2025-06-17' and '2025-07-11' order by p.date;", "intent": "join_splits"}
{"question": "Was NYSE open on 2025-08-25?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-08-25';", "intent": "calendar_filter"}
{"question": "Split-adjusted close series for STT.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='STT' order by date;", "intent": "adjusted_price"}
{"question": "Company profile for BG including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='BG';", "intent": "profile"}
{"question": "Monthly OHLCV for GPN in 2023-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='GPN' and month='2023-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for QCOM between 2023-11-15 and 2023-11-27.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='QCOM' and p.date between '2023-11-15' and '2023-11-27' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Financial Services that traded on 2024-03-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-27' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2024-12-05.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-12-05' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Dividend yield TTM time series for FTV.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='FTV' order by date;", "intent": "dividend_yield"}
{"question": "Dividend yield TTM time series for K.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='K' order by date;", "intent": "dividend_yield"}
{"question": "Show OHLCV for DVN on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DVN') select p.* from core.prices_daily p, d where p.ticker='DVN' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Year-to-date cumulative return for VRTX.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='VRTX' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Company profile for KKR including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='KKR';", "intent": "profile"}
{"question": "Tickers in sector Financial Services that traded on 2024-03-12.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-12' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Average close for RCL from 2024-02-22 to 2024-03-20.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='RCL' and date between '2024-02-22' and '2024-03-20';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for COP in week 2023-12-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='COP' and week='2023-12-11 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for AES between 2024-07-11 and 2024-08-06.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='AES' and p.date between '2024-07-11' and '2024-08-06' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for GOOG in week 2025-06-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='GOOG' and week='2025-06-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for HAL including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='HAL';", "intent": "profile"}
{"question": "Monthly OHLCV for ULTA in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ULTA' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for ERIE.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='ERIE' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Corporate actions for IBM ordered by date.", "sql": "select * from views.corporate_actions where ticker='IBM' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for CTSH in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CTSH' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for JPM in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='JPM' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for TFX in 2024-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TFX' and month='2024-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Real Estate on 2025-08-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-08-12';", "intent": "sector_aggregate"}
{"question": "Show OHLCV for CDNS on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='CDNS') select p.* from core.prices_daily p, d where p.ticker='CDNS' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for AMGN between 2024-09-11 and 2024-11-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='AMGN' and p.date between '2024-09-11' and '2024-11-12' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for ALGN in week 2024-05-06 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ALGN' and week='2024-05-06 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for CL in week 2024-03-25 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CL' and week='2024-03-25 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for BXP from 2023-12-08 to 2023-12-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='BXP' and date between '2023-12-08' and '2023-12-26';", "intent": "avg_between_dates"}
{"question": "Average close for FTNT from 2024-11-11 to 2024-12-06.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='FTNT' and date between '2024-11-11' and '2024-12-06';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for ARE in week 2025-09-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ARE' and week='2025-09-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Corporate actions for BKNG ordered by date.", "sql": "select * from views.corporate_actions where ticker='BKNG' order by event_date;", "intent": "corporate_actions"}
{"question": "Dividend yield TTM time series for IRM.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='IRM' order by date;", "intent": "dividend_yield"}
{"question": "Close price and dividend cash events for STT between 2024-01-05 and 2024-01-23.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='STT' and p.date between '2024-01-05' and '2024-01-23' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-02-01.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-02-01';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for ULTA in 2024-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ULTA' and month='2024-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for LOW in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='LOW' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close for LLY from 2025-02-19 to 2025-04-03.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='LLY' and date between '2025-02-19' and '2025-04-03';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for RVTY in 2025-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='RVTY' and month='2025-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for JBHT between 2025-06-12 and 2025-07-01.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='JBHT' and p.date between '2025-06-12' and '2025-07-01' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for EPAM in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EPAM' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for CME.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CME' order by date;", "intent": "adjusted_price"}
{"question": "Split-adjusted close series for TAP.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TAP' order by date;", "intent": "adjusted_price"}
{"question": "Show OHLCV for CTSH on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='CTSH') select p.* from core.prices_daily p, d where p.ticker='CTSH' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for UHS between 2024-10-24 and 2024-11-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='UHS' and p.date between '2024-10-24' and '2024-11-01' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for VZ between 2023-10-27 and 2023-11-22.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='VZ' and p.date between '2023-10-27' and '2023-11-22' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for D on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='D') select p.* from core.prices_daily p, d where p.ticker='D' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close for T from 2024-07-09 to 2024-10-10.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='T' and date between '2024-07-09' and '2024-10-10';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Energy on 2025-05-06.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2025-05-06';", "intent": "sector_aggregate"}
{"question": "Top 10 gainers by daily return on 2024-01-10.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-01-10' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and split factors for CDNS between 2024-12-12 and 2025-01-02.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CDNS' and p.date between '2024-12-12' and '2025-01-02' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for FDS between 2024-10-30 and 2024-11-21.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='FDS' and p.date between '2024-10-30' and '2024-11-21' order by p.date;", "intent": "join_splits"}
{"question": "7-day and 30-day returns for BAC.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='BAC' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and dividend cash events for LUV between 2024-05-31 and 2024-07-02.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LUV' and p.date between '2024-05-31' and '2024-07-02' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for SOLV in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SOLV' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2025-01-17.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2025-01-17';", "intent": "sector_aggregate"}
{"question": "Was NYSE open on 2024-08-12?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-08-12';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for SHW in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SHW' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for CHRW in week 2025-07-07 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CHRW' and week='2025-07-07 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and split factors for WRB between 2024-04-22 and 2024-05-28.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='WRB' and p.date between '2024-04-22' and '2024-05-28' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Basic Materials on 2024-09-05.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-09-05';", "intent": "sector_aggregate"}
{"question": "Company profile for UHS including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='UHS';", "intent": "profile"}
{"question": "Weekly OHLCV for APH in week 2025-06-16 00:00:00.", "sql": "select * from views.prices_weekly where ticker='APH' and week='2025-06-16 00:00:00';", "intent": "resample_weekly"}
{"question": "Split-adjusted close series for UDR.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='UDR' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for SCHW between 2024-04-29 and 2024-05-14.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='SCHW' and p.date between '2024-04-29' and '2024-05-14' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for DTE between 2025-08-06 and 2025-09-15.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='DTE' and p.date between '2025-08-06' and '2025-09-15' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for VST on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='VST') select p.* from core.prices_daily p, d where p.ticker='VST' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for ALGN between 2024-07-23 and 2024-07-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ALGN' and p.date between '2024-07-23' and '2024-07-31' order by p.date;", "intent": "join_splits"}
{"question": "Average close for FOXA from 2024-06-21 to 2024-08-23.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='FOXA' and date between '2024-06-21' and '2024-08-23';", "intent": "avg_between_dates"}
{"question": "Close price and split factors for CTVA between 2024-02-23 and 2024-04-18.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CTVA' and p.date between '2024-02-23' and '2024-04-18' order by p.date;", "intent": "join_splits"}
{"question": "Show OHLCV for NDAQ on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='NDAQ') select p.* from core.prices_daily p, d where p.ticker='NDAQ' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Show OHLCV for HST on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='HST') select p.* from core.prices_daily p, d where p.ticker='HST' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Corporate actions for SPG ordered by date.", "sql": "select * from views.corporate_actions where ticker='SPG' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for HD in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='HD' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for LYB between 2024-09-30 and 2024-10-22.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='LYB' and p.date between '2024-09-30' and '2024-10-22' order by p.date;", "intent": "join_splits"}
{"question": "Company profile for MAA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='MAA';", "intent": "profile"}
{"question": "Latest close and volume for XEL.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='XEL') select date, close, volume from core.prices_daily, mx where ticker='XEL' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for PNW between 2024-08-20 and 2024-10-11.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='PNW' and p.date between '2024-08-20' and '2024-10-11' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Real Estate on 2025-05-01.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-05-01';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for CSGP between 2025-02-03 and 2025-03-06.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CSGP' and p.date between '2025-02-03' and '2025-03-06' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for PGR between 2024-05-15 and 2024-06-21.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PGR' and p.date between '2024-05-15' and '2024-06-21' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Technology that traded on 2024-07-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-22' and t.sector='Technology' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for KMI in week 2024-03-18 00:00:00.", "sql": "select * from views.prices_weekly where ticker='KMI' and week='2024-03-18 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for NVR.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='NVR' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close for FRT from 2024-08-09 to 2024-08-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='FRT' and date between '2024-08-09' and '2024-08-21';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Basic Materials on 2024-07-08.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-07-08';", "intent": "sector_aggregate"}
{"question": "Top 10 gainers by daily return on 2025-07-31.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-07-31' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Tickers in sector Healthcare that traded on 2025-03-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-03-27' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Split-adjusted close series for AWK.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='AWK' order by date;", "intent": "adjusted_price"}
{"question": "Average close for WAT from 2024-10-24 to 2025-01-03.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='WAT' and date between '2024-10-24' and '2025-01-03';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for GEN in week 2024-03-25 00:00:00.", "sql": "select * from views.prices_weekly where ticker='GEN' and week='2024-03-25 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for LRCX from 2024-06-26 to 2024-07-12.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='LRCX' and date between '2024-06-26' and '2024-07-12';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for ANET in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ANET' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-01-23.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-01-23' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Basic Materials that traded on 2024-08-01.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-01' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Average close for EQIX from 2025-05-08 to 2025-06-12.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EQIX' and date between '2025-05-08' and '2025-06-12';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for HIG.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='HIG' order by date;", "intent": "adjusted_price"}
{"question": "Average close for GEN from 2025-01-16 to 2025-03-04.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GEN' and date between '2025-01-16' and '2025-03-04';", "intent": "avg_between_dates"}
{"question": "Company profile for PEP including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='PEP';", "intent": "profile"}
{"question": "Was NYSE open on 2024-11-18?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-11-18';", "intent": "calendar_filter"}
{"question": "Year-to-date cumulative return for XOM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='XOM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close for CHTR from 2024-03-13 to 2024-05-08.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CHTR' and date between '2024-03-13' and '2024-05-08';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2025-03-05?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-03-05';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for MCK in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MCK' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Technology on 2024-04-09.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-04-09';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for PFG in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PFG' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for AMTM.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AMTM') select date, close, volume from core.prices_daily, mx where ticker='AMTM' and date=mx.md;", "intent": "latest_point"}
{"question": "7-day and 30-day returns for CCI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='CCI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Tickers in sector Utilities that traded on 2024-05-08.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-05-08' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for MPWR in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MPWR' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for HUBB in 2024-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='HUBB' and month='2024-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for ROL between 2024-07-19 and 2024-07-31.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ROL' and p.date between '2024-07-19' and '2024-07-31' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for ZBH in week 2023-12-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ZBH' and week='2023-12-11 00:00:00';", "intent": "resample_weekly"}
{"question": "Top 10 gainers by daily return on 2025-02-03.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-02-03' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Utilities on 2024-04-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2024-04-12';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for TYL in week 2024-10-21 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TYL' and week='2024-10-21 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and split factors for REGN between 2024-06-12 and 2024-09-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='REGN' and p.date between '2024-06-12' and '2024-09-16' order by p.date;", "intent": "join_splits"}
{"question": "Split-adjusted close series for YUM.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='YUM' order by date;", "intent": "adjusted_price"}
{"question": "Year-to-date cumulative return for CDNS.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CDNS' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and split factors for PEG between 2025-03-25 and 2025-04-25.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PEG' and p.date between '2025-03-25' and '2025-04-25' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Healthcare on 2025-02-19.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2025-02-19';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for LRCX between 2024-10-07 and 2025-01-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='LRCX' and p.date between '2024-10-07' and '2025-01-16' order by p.date;", "intent": "join_splits"}
{"question": "Corporate actions for MPC ordered by date.", "sql": "select * from views.corporate_actions where ticker='MPC' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and split factors for GL between 2024-05-28 and 2024-08-06.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='GL' and p.date between '2024-05-28' and '2024-08-06' order by p.date;", "intent": "join_splits"}
{"question": "Average close for ESS from 2025-05-23 to 2025-06-16.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ESS' and date between '2025-05-23' and '2025-06-16';", "intent": "avg_between_dates"}
{"question": "Corporate actions for SWK ordered by date.", "sql": "select * from views.corporate_actions where ticker='SWK' order by event_date;", "intent": "corporate_actions"}
{"question": "Dividend yield TTM time series for BWA.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='BWA' order by date;", "intent": "dividend_yield"}
{"question": "Dividend yield TTM time series for AME.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='AME' order by date;", "intent": "dividend_yield"}
{"question": "Company profile for VTR including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='VTR';", "intent": "profile"}
{"question": "Corporate actions for EVRG ordered by date.", "sql": "select * from views.corporate_actions where ticker='EVRG' order by event_date;", "intent": "corporate_actions"}
{"question": "Top 10 gainers by daily return on 2025-08-29.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-08-29' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Dividend yield TTM time series for GIS.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='GIS' order by date;", "intent": "dividend_yield"}
{"question": "Average close for HOLX from 2025-03-07 to 2025-06-25.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HOLX' and date between '2025-03-07' and '2025-06-25';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for BX.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='BX' order by date;", "intent": "dividend_yield"}
{"question": "Split-adjusted close series for ARE.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ARE' order by date;", "intent": "adjusted_price"}
{"question": "Tickers in sector Industrials that traded on 2024-08-08.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-08' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for FDS in week 2025-04-21 00:00:00.", "sql": "select * from views.prices_weekly where ticker='FDS' and week='2025-04-21 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for CZR in week 2024-02-19 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CZR' and week='2024-02-19 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Utilities on 2023-10-25.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2023-10-25';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for RVTY between 2024-02-20 and 2024-02-27.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='RVTY' and p.date between '2024-02-20' and '2024-02-27' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Industrials on 2025-03-18.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2025-03-18';", "intent": "sector_aggregate"}
{"question": "Average close for IR from 2024-04-17 to 2024-04-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='IR' and date between '2024-04-17' and '2024-04-26';", "intent": "avg_between_dates"}
{"question": "Show OHLCV for BEN on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='BEN') select p.* from core.prices_daily p, d where p.ticker='BEN' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "7-day and 30-day returns for DVA.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='DVA' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Tickers in sector Basic Materials that traded on 2024-10-25.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-10-25' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Consumer Defensive that traded on 2023-11-07.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-11-07' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Show OHLCV for FAST on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='FAST') select p.* from core.prices_daily p, d where p.ticker='FAST' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Split-adjusted close series for CTAS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CTAS' order by date;", "intent": "adjusted_price"}
{"question": "Show OHLCV for TFX on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='TFX') select p.* from core.prices_daily p, d where p.ticker='TFX' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close for TPR from 2024-06-21 to 2024-07-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='TPR' and date between '2024-06-21' and '2024-07-17';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for TMO.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TMO' order by date;", "intent": "adjusted_price"}
{"question": "Close price and split factors for USB between 2025-01-06 and 2025-01-21.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='USB' and p.date between '2025-01-06' and '2025-01-21' order by p.date;", "intent": "join_splits"}
{"question": "Year-to-date cumulative return for MDLZ.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MDLZ' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Monthly OHLCV for D in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='D' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "7-day and 30-day returns for IBM.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='IBM' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Year-to-date cumulative return for MRNA.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MRNA' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Show OHLCV for PPG on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='PPG') select p.* from core.prices_daily p, d where p.ticker='PPG' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for ARE in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ARE' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for NFLX in week 2023-12-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NFLX' and week='2023-12-11 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Healthcare that traded on 2024-07-08.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-08' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Company profile for GWW including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='GWW';", "intent": "profile"}
{"question": "Dividend yield TTM time series for COF.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='COF' order by date;", "intent": "dividend_yield"}
{"question": "Corporate actions for YUM ordered by date.", "sql": "select * from views.corporate_actions where ticker='YUM' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Healthcare on 2024-03-22.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-03-22';", "intent": "sector_aggregate"}
{"question": "Split-adjusted close series for CNC.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CNC' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for IDXX between 2024-02-26 and 2024-03-21.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IDXX' and p.date between '2024-02-26' and '2024-03-21' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-09-03.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-09-03';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Basic Materials that traded on 2024-11-26.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-11-26' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Was NYSE open on 2025-03-25?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-03-25';", "intent": "calendar_filter"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-11-29.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-11-29';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Industrials that traded on 2025-03-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-03-27' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Average close for KEY from 2025-01-06 to 2025-03-06.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='KEY' and date between '2025-01-06' and '2025-03-06';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for CCI in week 2025-05-05 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CCI' and week='2025-05-05 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for WRB.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='WRB' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Year-to-date cumulative return for CI.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CI' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-04-11.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-04-11' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for PEP.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='PEP') select date, close, volume from core.prices_daily, mx where ticker='PEP' and date=mx.md;", "intent": "latest_point"}
{"question": "Monthly OHLCV for RJF in 2025-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='RJF' and month='2025-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Was NYSE open on 2024-03-08?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-03-08';", "intent": "calendar_filter"}
{"question": "Company profile for EA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='EA';", "intent": "profile"}
{"question": "Corporate actions for ESS ordered by date.", "sql": "select * from views.corporate_actions where ticker='ESS' order by event_date;", "intent": "corporate_actions"}
{"question": "Latest close and volume for PCAR.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='PCAR') select date, close, volume from core.prices_daily, mx where ticker='PCAR' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for CMI between 2025-03-14 and 2025-06-03.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CMI' and p.date between '2025-03-14' and '2025-06-03' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for CRM.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='CRM') select date, close, volume from core.prices_daily, mx where ticker='CRM' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and split factors for NEM between 2024-08-26 and 2024-09-04.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='NEM' and p.date between '2024-08-26' and '2024-09-04' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for SPG between 2025-07-28 and 2025-08-13.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='SPG' and p.date between '2025-07-28' and '2025-08-13' order by p.date;", "intent": "join_splits"}
{"question": "Show OHLCV for SWK on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='SWK') select p.* from core.prices_daily p, d where p.ticker='SWK' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close and total volume for sector Real Estate on 2024-04-18.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2024-04-18';", "intent": "sector_aggregate"}
{"question": "Corporate actions for IR ordered by date.", "sql": "select * from views.corporate_actions where ticker='IR' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for SLB in 2023-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SLB' and month='2023-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close for CMCSA from 2025-08-08 to 2025-09-15.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CMCSA' and date between '2025-08-08' and '2025-09-15';", "intent": "avg_between_dates"}
{"question": "Top 10 gainers by daily return on 2025-03-17.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-03-17' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Monthly OHLCV for NWSA in 2025-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NWSA' and month='2025-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for ALB.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ALB' order by date;", "intent": "adjusted_price"}
{"question": "Corporate actions for UNP ordered by date.", "sql": "select * from views.corporate_actions where ticker='UNP' order by event_date;", "intent": "corporate_actions"}
{"question": "Tickers in sector Consumer Defensive that traded on 2025-07-28.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-07-28' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for MSFT.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='MSFT') select date, close, volume from core.prices_daily, mx where ticker='MSFT' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for SOLV in week 2025-06-30 00:00:00.", "sql": "select * from views.prices_weekly where ticker='SOLV' and week='2025-06-30 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and split factors for GPN between 2023-12-12 and 2023-12-20.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='GPN' and p.date between '2023-12-12' and '2023-12-20' order by p.date;", "intent": "join_splits"}
{"question": "Show OHLCV for TPL on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='TPL') select p.* from core.prices_daily p, d where p.ticker='TPL' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Dividend yield TTM time series for COST.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='COST' order by date;", "intent": "dividend_yield"}
{"question": "Close price and dividend cash events for ESS between 2025-09-10 and 2025-09-30.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ESS' and p.date between '2025-09-10' and '2025-09-30' order by p.date;", "intent": "join_dividends"}
{"question": "Company profile for WAT including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='WAT';", "intent": "profile"}
{"question": "Close price and split factors for DELL between 2023-12-15 and 2024-03-26.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DELL' and p.date between '2023-12-15' and '2024-03-26' order by p.date;", "intent": "join_splits"}
{"question": "Company profile for DAY including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='DAY';", "intent": "profile"}
{"question": "Average close for JBHT from 2024-09-30 to 2024-11-08.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='JBHT' and date between '2024-09-30' and '2024-11-08';", "intent": "avg_between_dates"}
{"question": "Year-to-date cumulative return for MSFT.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MSFT' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for ED between 2024-11-26 and 2025-01-27.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ED' and p.date between '2024-11-26' and '2025-01-27' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Technology that traded on 2024-02-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-02-22' and t.sector='Technology' order by 1;", "intent": "membership"}
{"question": "Average close for LUV from 2024-07-15 to 2024-08-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='LUV' and date between '2024-07-15' and '2024-08-26';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for OMC in week 2024-12-16 00:00:00.", "sql": "select * from views.prices_weekly where ticker='OMC' and week='2024-12-16 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for IT from 2025-07-30 to 2025-09-22.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='IT' and date between '2025-07-30' and '2025-09-22';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2024-07-23?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-07-23';", "intent": "calendar_filter"}
{"question": "Average close for IVZ from 2025-07-03 to 2025-08-20.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='IVZ' and date between '2025-07-03' and '2025-08-20';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Healthcare on 2025-04-21.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2025-04-21';", "intent": "sector_aggregate"}
{"question": "Corporate actions for FOXA ordered by date.", "sql": "select * from views.corporate_actions where ticker='FOXA' order by event_date;", "intent": "corporate_actions"}
{"question": "Year-to-date cumulative return for IQV.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='IQV' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for BIIB between 2024-12-24 and 2025-01-16.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='BIIB' and p.date between '2024-12-24' and '2025-01-16' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Communication Services that traded on 2025-09-24.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-09-24' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Was NYSE open on 2024-01-04?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-01-04';", "intent": "calendar_filter"}
{"question": "Weekly OHLCV for RL in week 2024-10-21 00:00:00.", "sql": "select * from views.prices_weekly where ticker='RL' and week='2024-10-21 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for TXT in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TXT' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Industrials on 2025-05-06.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2025-05-06';", "intent": "sector_aggregate"}
{"question": "Company profile for EXR including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='EXR';", "intent": "profile"}
{"question": "7-day and 30-day returns for MTB.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='MTB' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close for DIS from 2024-11-06 to 2024-11-20.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DIS' and date between '2024-11-06' and '2024-11-20';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for PFE in week 2025-05-19 00:00:00.", "sql": "select * from views.prices_weekly where ticker='PFE' and week='2025-05-19 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for CRL between 2024-08-27 and 2024-09-19.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CRL' and p.date between '2024-08-27' and '2024-09-19' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Technology on 2024-09-06.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-09-06';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for CNC between 2024-02-07 and 2024-04-01.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CNC' and p.date between '2024-02-07' and '2024-04-01' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2025-01-07?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-01-07';", "intent": "calendar_filter"}
{"question": "Close price and split factors for MO between 2025-02-06 and 2025-02-14.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MO' and p.date between '2025-02-06' and '2025-02-14' order by p.date;", "intent": "join_splits"}
{"question": "Split-adjusted close series for SYY.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='SYY' order by date;", "intent": "adjusted_price"}
{"question": "Average close for TER from 2025-03-05 to 2025-04-01.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='TER' and date between '2025-03-05' and '2025-04-01';", "intent": "avg_between_dates"}
{"question": "Top 10 gainers by daily return on 2024-12-03.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-12-03' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Was NYSE open on 2025-03-21?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-03-21';", "intent": "calendar_filter"}
{"question": "Split-adjusted close series for VRSK.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='VRSK' order by date;", "intent": "adjusted_price"}
{"question": "Year-to-date cumulative return for WST.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='WST' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Top 10 gainers by daily return on 2024-08-13.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-08-13' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for TDG in week 2024-04-22 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TDG' and week='2024-04-22 00:00:00';", "intent": "resample_weekly"}
{"question": "Latest close and volume for FOXA.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='FOXA') select date, close, volume from core.prices_daily, mx where ticker='FOXA' and date=mx.md;", "intent": "latest_point"}
{"question": "Top 10 gainers by daily return on 2023-12-27.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2023-12-27' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for MOH in week 2025-09-29 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MOH' and week='2025-09-29 00:00:00';", "intent": "resample_weekly"}
{"question": "Split-adjusted close series for ADSK.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ADSK' order by date;", "intent": "adjusted_price"}
{"question": "Average close for CSCO from 2025-07-29 to 2025-08-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CSCO' and date between '2025-07-29' and '2025-08-11';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Consumer Defensive that traded on 2025-02-25.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-02-25' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2025-03-12.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-03-12' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Basic Materials on 2024-02-15.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-02-15';", "intent": "sector_aggregate"}
{"question": "Show OHLCV for VTR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='VTR') select p.* from core.prices_daily p, d where p.ticker='VTR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Split-adjusted close series for CMS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CMS' order by date;", "intent": "adjusted_price"}
{"question": "Weekly OHLCV for IDXX in week 2025-08-04 00:00:00.", "sql": "select * from views.prices_weekly where ticker='IDXX' and week='2025-08-04 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for GM including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='GM';", "intent": "profile"}
{"question": "Dividend yield TTM time series for PFG.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PFG' order by date;", "intent": "dividend_yield"}
{"question": "Show OHLCV for DOC on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DOC') select p.* from core.prices_daily p, d where p.ticker='DOC' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Weekly OHLCV for VLO in week 2025-04-21 00:00:00.", "sql": "select * from views.prices_weekly where ticker='VLO' and week='2025-04-21 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for ULTA.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='ULTA' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and split factors for EQR between 2024-07-12 and 2024-08-07.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='EQR' and p.date between '2024-07-12' and '2024-08-07' order by p.date;", "intent": "join_splits"}
{"question": "Average close for NKE from 2024-02-28 to 2024-03-15.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='NKE' and date between '2024-02-28' and '2024-03-15';", "intent": "avg_between_dates"}
{"question": "7-day and 30-day returns for ALL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='ALL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Monthly OHLCV for NTRS in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NTRS' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for MDLZ in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MDLZ' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for KMI between 2024-06-03 and 2024-06-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KMI' and p.date between '2024-06-03' and '2024-06-12' order by p.date;", "intent": "join_splits"}
{"question": "Show OHLCV for COF on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='COF') select p.* from core.prices_daily p, d where p.ticker='COF' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for DG in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DG' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for ULTA between 2025-02-14 and 2025-04-25.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ULTA' and p.date between '2025-02-14' and '2025-04-25' order by p.date;", "intent": "join_splits"}
{"question": "Average close for CSGP from 2024-02-08 to 2024-04-05.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CSGP' and date between '2024-02-08' and '2024-04-05';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Financial Services that traded on 2025-08-04.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-08-04' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for BKR.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='BKR') select date, close, volume from core.prices_daily, mx where ticker='BKR' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for PCG in week 2023-12-25 00:00:00.", "sql": "select * from views.prices_weekly where ticker='PCG' and week='2023-12-25 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for GD including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='GD';", "intent": "profile"}
{"question": "Top 10 gainers by daily return on 2024-06-05.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-06-05' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for OXY in week 2025-08-25 00:00:00.", "sql": "select * from views.prices_weekly where ticker='OXY' and week='2025-08-25 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for SPG in week 2025-03-24 00:00:00.", "sql": "select * from views.prices_weekly where ticker='SPG' and week='2025-03-24 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for ROST between 2024-05-03 and 2024-05-13.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ROST' and p.date between '2024-05-03' and '2024-05-13' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Industrials on 2024-10-23.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2024-10-23';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for AMT in week 2025-05-12 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AMT' and week='2025-05-12 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for EVRG from 2024-03-21 to 2024-04-15.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EVRG' and date between '2024-03-21' and '2024-04-15';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for GILD in 2024-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='GILD' and month='2024-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for EVRG including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='EVRG';", "intent": "profile"}
{"question": "Average close for FCX from 2024-08-12 to 2024-09-04.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='FCX' and date between '2024-08-12' and '2024-09-04';", "intent": "avg_between_dates"}
{"question": "Corporate actions for ORLY ordered by date.", "sql": "select * from views.corporate_actions where ticker='ORLY' order by event_date;", "intent": "corporate_actions"}
{"question": "Year-to-date cumulative return for IDXX.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='IDXX' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Latest close and volume for MHK.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='MHK') select date, close, volume from core.prices_daily, mx where ticker='MHK' and date=mx.md;", "intent": "latest_point"}
{"question": "Tickers in sector Real Estate that traded on 2024-04-03.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-04-03' and t.sector='Real Estate' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-05-20.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-05-20' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for NOC in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NOC' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "7-day and 30-day returns for AFL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='AFL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and split factors for ALB between 2024-10-28 and 2025-01-08.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ALB' and p.date between '2024-10-28' and '2025-01-08' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for NCLH in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NCLH' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Industrials that traded on 2025-10-03.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-10-03' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Dividend yield TTM time series for EIX.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='EIX' order by date;", "intent": "dividend_yield"}
{"question": "Was NYSE open on 2025-05-23?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-05-23';", "intent": "calendar_filter"}
{"question": "Close price and dividend cash events for LUV between 2024-05-03 and 2024-06-14.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LUV' and p.date between '2024-05-03' and '2024-06-14' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for MGM on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='MGM') select p.* from core.prices_daily p, d where p.ticker='MGM' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "7-day and 30-day returns for NRG.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='NRG' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close for CRWD from 2025-06-06 to 2025-06-24.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CRWD' and date between '2025-06-06' and '2025-06-24';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for RSG in week 2024-01-01 00:00:00.", "sql": "select * from views.prices_weekly where ticker='RSG' and week='2024-01-01 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for VMC on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='VMC') select p.* from core.prices_daily p, d where p.ticker='VMC' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for QRVO between 2024-11-27 and 2025-01-29.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='QRVO' and p.date between '2024-11-27' and '2025-01-29' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for ITW in 2024-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ITW' and month='2024-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for HUBB including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='HUBB';", "intent": "profile"}
{"question": "Dividend yield TTM time series for RCL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='RCL' order by date;", "intent": "dividend_yield"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-02-16.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-02-16';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for CTSH in 2024-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CTSH' and month='2024-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for VZ.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='VZ' order by date;", "intent": "adjusted_price"}
{"question": "Dividend yield TTM time series for UNH.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='UNH' order by date;", "intent": "dividend_yield"}
{"question": "Corporate actions for CTRA ordered by date.", "sql": "select * from views.corporate_actions where ticker='CTRA' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Basic Materials on 2024-06-13.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-06-13';", "intent": "sector_aggregate"}
{"question": "7-day and 30-day returns for HCA.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='HCA' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Tickers in sector Healthcare that traded on 2024-07-19.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-19' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for ATO in week 2024-12-09 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ATO' and week='2024-12-09 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for MHK on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='MHK') select p.* from core.prices_daily p, d where p.ticker='MHK' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-09-19.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-09-19';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for TSN in week 2025-07-21 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TSN' and week='2025-07-21 00:00:00';", "intent": "resample_weekly"}
{"question": "Latest close and volume for CHTR.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='CHTR') select date, close, volume from core.prices_daily, mx where ticker='CHTR' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close and total volume for sector Real Estate on 2025-07-23.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-07-23';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for WY in 2023-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='WY' and month='2023-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for SWK between 2025-08-18 and 2025-10-06.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='SWK' and p.date between '2025-08-18' and '2025-10-06' order by p.date;", "intent": "join_dividends"}
{"question": "Corporate actions for MHK ordered by date.", "sql": "select * from views.corporate_actions where ticker='MHK' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for ATO in 2025-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ATO' and month='2025-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for GEV between 2024-12-04 and 2024-12-19.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GEV' and p.date between '2024-12-04' and '2024-12-19' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for SMCI in week 2025-10-13 00:00:00.", "sql": "select * from views.prices_weekly where ticker='SMCI' and week='2025-10-13 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Communication Services that traded on 2025-08-07.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-08-07' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Consumer Defensive on 2025-02-06.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2025-02-06';", "intent": "sector_aggregate"}
{"question": "Latest close and volume for IEX.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='IEX') select date, close, volume from core.prices_daily, mx where ticker='IEX' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and split factors for FOXA between 2024-12-18 and 2025-03-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='FOXA' and p.date between '2024-12-18' and '2025-03-12' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Industrials on 2025-08-13.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2025-08-13';", "intent": "sector_aggregate"}
{"question": "Company profile for PCG including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='PCG';", "intent": "profile"}
{"question": "Top 10 gainers by daily return on 2024-02-26.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-02-26' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for CEG between 2024-07-30 and 2024-09-06.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CEG' and p.date between '2024-07-30' and '2024-09-06' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for KMX in week 2024-11-18 00:00:00.", "sql": "select * from views.prices_weekly where ticker='KMX' and week='2024-11-18 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for APA in week 2024-07-01 00:00:00.", "sql": "select * from views.prices_weekly where ticker='APA' and week='2024-07-01 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for GLW.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='GLW' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and split factors for BBY between 2024-07-18 and 2024-09-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='BBY' and p.date between '2024-07-18' and '2024-09-16' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for NDAQ in week 2024-01-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NDAQ' and week='2024-01-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for FFIV between 2025-06-09 and 2025-07-14.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='FFIV' and p.date between '2025-06-09' and '2025-07-14' order by p.date;", "intent": "join_dividends"}
{"question": "Year-to-date cumulative return for CTSH.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CTSH' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Dividend yield TTM time series for UBER.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='UBER' order by date;", "intent": "dividend_yield"}
{"question": "Average close for MLM from 2024-06-18 to 2024-07-01.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='MLM' and date between '2024-06-18' and '2024-07-01';", "intent": "avg_between_dates"}
{"question": "7-day and 30-day returns for SNA.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='SNA' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close and total volume for sector Healthcare on 2025-06-23.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2025-06-23';", "intent": "sector_aggregate"}
{"question": "Corporate actions for CARR ordered by date.", "sql": "select * from views.corporate_actions where ticker='CARR' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for TRV in 2023-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TRV' and month='2023-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for EXC.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='EXC' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Tickers in sector Utilities that traded on 2024-01-29.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-01-29' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Show OHLCV for CHD on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='CHD') select p.* from core.prices_daily p, d where p.ticker='CHD' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Dividend yield TTM time series for RJF.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='RJF' order by date;", "intent": "dividend_yield"}
{"question": "Close price and split factors for VRTX between 2024-12-24 and 2025-01-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='VRTX' and p.date between '2024-12-24' and '2025-01-16' order by p.date;", "intent": "join_splits"}
{"question": "Average close for PNC from 2025-03-28 to 2025-06-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PNC' and date between '2025-03-28' and '2025-06-11';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Healthcare on 2025-03-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2025-03-12';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Consumer Defensive on 2025-09-04.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2025-09-04';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Basic Materials on 2025-07-03.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2025-07-03';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Energy on 2025-07-10.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2025-07-10';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for STT between 2024-03-18 and 2024-03-27.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='STT' and p.date between '2024-03-18' and '2024-03-27' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for LYB between 2024-02-22 and 2024-04-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='LYB' and p.date between '2024-02-22' and '2024-04-12' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for PFG between 2024-06-03 and 2024-06-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='PFG' and p.date between '2024-06-03' and '2024-06-17' order by p.date;", "intent": "join_dividends"}
{"question": "Top 10 gainers by daily return on 2024-07-31.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-07-31' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Monthly OHLCV for SLB in 2025-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SLB' and month='2025-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for MSCI in week 2024-08-26 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MSCI' and week='2024-08-26 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for SMCI in week 2024-12-30 00:00:00.", "sql": "select * from views.prices_weekly where ticker='SMCI' and week='2024-12-30 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for HUBB from 2025-01-15 to 2025-02-25.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HUBB' and date between '2025-01-15' and '2025-02-25';", "intent": "avg_between_dates"}
{"question": "Average close for UAL from 2024-03-20 to 2024-05-15.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='UAL' and date between '2024-03-20' and '2024-05-15';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Financial Services that traded on 2025-03-07.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-03-07' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Basic Materials on 2023-11-07.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2023-11-07';", "intent": "sector_aggregate"}
{"question": "Average close for INCY from 2025-05-30 to 2025-06-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='INCY' and date between '2025-05-30' and '2025-06-11';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for VTR in week 2024-01-29 00:00:00.", "sql": "select * from views.prices_weekly where ticker='VTR' and week='2024-01-29 00:00:00';", "intent": "resample_weekly"}
{"question": "Dividend yield TTM time series for TSN.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='TSN' order by date;", "intent": "dividend_yield"}
{"question": "Average close for PKG from 2024-04-18 to 2024-04-25.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PKG' and date between '2024-04-18' and '2024-04-25';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for CFG in 2024-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CFG' and month='2024-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for BWA.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='BWA' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Show OHLCV for GM on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='GM') select p.* from core.prices_daily p, d where p.ticker='GM' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Was NYSE open on 2025-05-06?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-05-06';", "intent": "calendar_filter"}
{"question": "Year-to-date cumulative return for TFX.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='TFX' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Monthly OHLCV for SYY in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SYY' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "7-day and 30-day returns for ADI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='ADI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Monthly OHLCV for VLO in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='VLO' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Technology on 2024-11-08.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-11-08';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for FMC in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='FMC' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Was NYSE open on 2025-01-28?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-01-28';", "intent": "calendar_filter"}
{"question": "Average close for REG from 2023-12-12 to 2024-03-15.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='REG' and date between '2023-12-12' and '2024-03-15';", "intent": "avg_between_dates"}
{"question": "7-day and 30-day returns for AIG.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='AIG' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Was NYSE open on 2025-02-03?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-02-03';", "intent": "calendar_filter"}
{"question": "Average close and total volume for sector Consumer Defensive on 2025-02-21.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2025-02-21';", "intent": "sector_aggregate"}
{"question": "Was NYSE open on 2024-05-10?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-05-10';", "intent": "calendar_filter"}
{"question": "Company profile for IVZ including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='IVZ';", "intent": "profile"}
{"question": "Average close for PSX from 2024-05-31 to 2024-06-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PSX' and date between '2024-05-31' and '2024-06-21';", "intent": "avg_between_dates"}
{"question": "Average close for HAS from 2025-02-20 to 2025-04-02.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HAS' and date between '2025-02-20' and '2025-04-02';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for SYY.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='SYY' order by date;", "intent": "dividend_yield"}
{"question": "Dividend yield TTM time series for ZBRA.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='ZBRA' order by date;", "intent": "dividend_yield"}
{"question": "Average close for SMCI from 2025-04-09 to 2025-04-23.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='SMCI' and date between '2025-04-09' and '2025-04-23';", "intent": "avg_between_dates"}
{"question": "Year-to-date cumulative return for UPS.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='UPS' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Dividend yield TTM time series for SRE.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='SRE' order by date;", "intent": "dividend_yield"}
{"question": "Close price and split factors for MTCH between 2024-06-07 and 2024-08-05.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MTCH' and p.date between '2024-06-07' and '2024-08-05' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for PAYX between 2025-03-19 and 2025-03-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PAYX' and p.date between '2025-03-19' and '2025-03-31' order by p.date;", "intent": "join_splits"}
{"question": "7-day and 30-day returns for SYF.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='SYF' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Top 10 gainers by daily return on 2025-09-02.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-09-02' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Monthly OHLCV for TRV in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TRV' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for ECL in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ECL' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for ORLY between 2024-10-24 and 2025-01-02.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ORLY' and p.date between '2024-10-24' and '2025-01-02' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for KKR between 2024-08-14 and 2024-10-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KKR' and p.date between '2024-08-14' and '2024-10-31' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Consumer Defensive on 2023-12-11.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2023-12-11';", "intent": "sector_aggregate"}
{"question": "Latest close and volume for CLX.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='CLX') select date, close, volume from core.prices_daily, mx where ticker='CLX' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for DXCM from 2025-05-06 to 2025-07-22.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DXCM' and date between '2025-05-06' and '2025-07-22';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2025-06-09?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-06-09';", "intent": "calendar_filter"}
{"question": "Latest close and volume for KO.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='KO') select date, close, volume from core.prices_daily, mx where ticker='KO' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and split factors for JNJ between 2025-04-04 and 2025-04-30.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='JNJ' and p.date between '2025-04-04' and '2025-04-30' order by p.date;", "intent": "join_splits"}
{"question": "Average close for AXP from 2024-08-29 to 2024-09-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='AXP' and date between '2024-08-29' and '2024-09-26';", "intent": "avg_between_dates"}
{"question": "Close price and split factors for WST between 2024-12-20 and 2025-04-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='WST' and p.date between '2024-12-20' and '2025-04-01' order by p.date;", "intent": "join_splits"}
{"question": "Was NYSE open on 2024-02-06?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-02-06';", "intent": "calendar_filter"}
{"question": "Year-to-date cumulative return for VTRS.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='VTRS' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-12-03.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-12-03';", "intent": "sector_aggregate"}
{"question": "7-day and 30-day returns for AVGO.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='AVGO' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close and total volume for sector Financial Services on 2024-09-05.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-09-05';", "intent": "sector_aggregate"}
{"question": "Year-to-date cumulative return for PM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='PM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Was NYSE open on 2024-02-23?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-02-23';", "intent": "calendar_filter"}
{"question": "Was NYSE open on 2024-08-19?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-08-19';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for BIIB in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='BIIB' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for LNT between 2024-09-19 and 2024-11-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='LNT' and p.date between '2024-09-19' and '2024-11-01' order by p.date;", "intent": "join_splits"}
{"question": "Latest close and volume for AZO.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AZO') select date, close, volume from core.prices_daily, mx where ticker='AZO' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for GEHC between 2024-04-19 and 2024-06-20.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GEHC' and p.date between '2024-04-19' and '2024-06-20' order by p.date;", "intent": "join_dividends"}
{"question": "Corporate actions for TSCO ordered by date.", "sql": "select * from views.corporate_actions where ticker='TSCO' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and dividend cash events for NRG between 2025-03-18 and 2025-04-04.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='NRG' and p.date between '2025-03-18' and '2025-04-04' order by p.date;", "intent": "join_dividends"}
{"question": "Split-adjusted close series for HLT.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='HLT' order by date;", "intent": "adjusted_price"}
{"question": "Top 10 gainers by daily return on 2024-05-31.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-05-31' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Real Estate on 2024-04-09.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2024-04-09';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for UDR between 2025-01-28 and 2025-02-28.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='UDR' and p.date between '2025-01-28' and '2025-02-28' order by p.date;", "intent": "join_splits"}
{"question": "Average close for DLTR from 2025-02-19 to 2025-03-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DLTR' and date between '2025-02-19' and '2025-03-26';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for HPE.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='HPE' order by date;", "intent": "dividend_yield"}
{"question": "Company profile for IEX including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='IEX';", "intent": "profile"}
{"question": "Top 10 gainers by daily return on 2025-08-11.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-08-11' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Latest close and volume for BK.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='BK') select date, close, volume from core.prices_daily, mx where ticker='BK' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for CMI between 2025-09-10 and 2025-10-02.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CMI' and p.date between '2025-09-10' and '2025-10-02' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Real Estate on 2025-02-27.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-02-27';", "intent": "sector_aggregate"}
{"question": "Top 10 gainers by daily return on 2025-08-13.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-08-13' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Utilities on 2024-06-10.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2024-06-10';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for LH between 2024-01-09 and 2024-03-05.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LH' and p.date between '2024-01-09' and '2024-03-05' order by p.date;", "intent": "join_dividends"}
{"question": "Year-to-date cumulative return for KIM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='KIM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Top 10 gainers by daily return on 2025-02-12.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-02-12' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for TSLA between 2023-12-19 and 2024-02-15.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='TSLA' and p.date between '2023-12-19' and '2024-02-15' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for IFF.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='IFF') select date, close, volume from core.prices_daily, mx where ticker='IFF' and date=mx.md;", "intent": "latest_point"}
{"question": "Latest close and volume for BIIB.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='BIIB') select date, close, volume from core.prices_daily, mx where ticker='BIIB' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close and total volume for sector Communication Services on 2024-06-18.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-06-18';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for WMT in week 2024-06-10 00:00:00.", "sql": "select * from views.prices_weekly where ticker='WMT' and week='2024-06-10 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for PFE in week 2024-12-09 00:00:00.", "sql": "select * from views.prices_weekly where ticker='PFE' and week='2024-12-09 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Energy that traded on 2024-03-15.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-15' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Dividend yield TTM time series for BR.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='BR' order by date;", "intent": "dividend_yield"}
{"question": "Weekly OHLCV for STLD in week 2024-07-22 00:00:00.", "sql": "select * from views.prices_weekly where ticker='STLD' and week='2024-07-22 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Financial Services on 2024-05-13.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-05-13';", "intent": "sector_aggregate"}
{"question": "Dividend yield TTM time series for SJM.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='SJM' order by date;", "intent": "dividend_yield"}
{"question": "Average close for AIG from 2025-04-30 to 2025-05-09.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='AIG' and date between '2025-04-30' and '2025-05-09';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for DIS between 2025-09-02 and 2025-09-19.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='DIS' and p.date between '2025-09-02' and '2025-09-19' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for SCHW in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SCHW' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for FI between 2025-08-12 and 2025-09-03.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='FI' and p.date between '2025-08-12' and '2025-09-03' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for CME on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='CME') select p.* from core.prices_daily p, d where p.ticker='CME' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Weekly OHLCV for AMGN in week 2024-12-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AMGN' and week='2024-12-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for KR between 2025-05-16 and 2025-06-16.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='KR' and p.date between '2025-05-16' and '2025-06-16' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for EL in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EL' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for ADSK in 2025-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ADSK' and month='2025-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close for JNJ from 2024-09-19 to 2024-11-06.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='JNJ' and date between '2024-09-19' and '2024-11-06';", "intent": "avg_between_dates"}
{"question": "Top 10 gainers by daily return on 2025-09-05.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-09-05' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for CPAY in week 2025-05-19 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CPAY' and week='2025-05-19 00:00:00';", "intent": "resample_weekly"}
{"question": "Was NYSE open on 2025-04-14?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-04-14';", "intent": "calendar_filter"}
{"question": "Close price and split factors for ON between 2024-01-05 and 2024-01-19.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ON' and p.date between '2024-01-05' and '2024-01-19' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Healthcare on 2023-10-31.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2023-10-31';", "intent": "sector_aggregate"}
{"question": "Dividend yield TTM time series for NRG.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='NRG' order by date;", "intent": "dividend_yield"}
{"question": "Latest close and volume for PNW.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='PNW') select date, close, volume from core.prices_daily, mx where ticker='PNW' and date=mx.md;", "intent": "latest_point"}
{"question": "Show OHLCV for SHW on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='SHW') select p.* from core.prices_daily p, d where p.ticker='SHW' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Top 10 gainers by daily return on 2025-07-03.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-07-03' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and split factors for MSCI between 2025-04-11 and 2025-06-20.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MSCI' and p.date between '2025-04-11' and '2025-06-20' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for EIX in week 2025-06-09 00:00:00.", "sql": "select * from views.prices_weekly where ticker='EIX' and week='2025-06-09 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for AMP from 2024-06-12 to 2024-07-31.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='AMP' and date between '2024-06-12' and '2024-07-31';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Communication Services that traded on 2024-06-18.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-06-18' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for PKG in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PKG' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Industrials that traded on 2025-10-16.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-10-16' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Financial Services that traded on 2025-04-29.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-04-29' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Average close for CAG from 2024-06-10 to 2024-07-29.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CAG' and date between '2024-06-10' and '2024-07-29';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2025-01-29?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-01-29';", "intent": "calendar_filter"}
{"question": "Weekly OHLCV for CE in week 2024-12-02 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CE' and week='2024-12-02 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Industrials that traded on 2024-08-28.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-28' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2024-08-20.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-08-20' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-04-10.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-04-10' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Company profile for CHD including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CHD';", "intent": "profile"}
{"question": "Year-to-date cumulative return for PLD.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='PLD' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close for TJX from 2024-01-12 to 2024-03-13.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='TJX' and date between '2024-01-12' and '2024-03-13';", "intent": "avg_between_dates"}
{"question": "Average close for DIS from 2025-07-28 to 2025-09-05.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DIS' and date between '2025-07-28' and '2025-09-05';", "intent": "avg_between_dates"}
{"question": "Show OHLCV for BLK on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='BLK') select p.* from core.prices_daily p, d where p.ticker='BLK' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for AES between 2024-10-29 and 2025-01-10.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='AES' and p.date between '2024-10-29' and '2025-01-10' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for ED between 2024-05-13 and 2024-06-13.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ED' and p.date between '2024-05-13' and '2024-06-13' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2023-11-06?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-11-06';", "intent": "calendar_filter"}
{"question": "Year-to-date cumulative return for HWM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='HWM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for ON in week 2025-08-25 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ON' and week='2025-08-25 00:00:00';", "intent": "resample_weekly"}
{"question": "Was NYSE open on 2024-09-26?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-09-26';", "intent": "calendar_filter"}
{"question": "Average close for NKE from 2025-08-05 to 2025-09-02.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='NKE' and date between '2025-08-05' and '2025-09-02';", "intent": "avg_between_dates"}
{"question": "Company profile for QCOM including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='QCOM';", "intent": "profile"}
{"question": "Tickers in sector Healthcare that traded on 2024-12-30.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-12-30' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Consumer Defensive on 2025-01-17.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2025-01-17';", "intent": "sector_aggregate"}
{"question": "Average close for PWR from 2024-06-21 to 2024-07-02.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PWR' and date between '2024-06-21' and '2024-07-02';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Real Estate that traded on 2024-07-30.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-30' and t.sector='Real Estate' order by 1;", "intent": "membership"}
{"question": "Year-to-date cumulative return for MO.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MO' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Show OHLCV for GE on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='GE') select p.* from core.prices_daily p, d where p.ticker='GE' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for REGN in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='REGN' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for KMX.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='KMX') select date, close, volume from core.prices_daily, mx where ticker='KMX' and date=mx.md;", "intent": "latest_point"}
{"question": "Tickers in sector Financial Services that traded on 2024-04-05.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-04-05' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for SCHW.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='SCHW') select date, close, volume from core.prices_daily, mx where ticker='SCHW' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and split factors for AEE between 2024-12-12 and 2024-12-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='AEE' and p.date between '2024-12-12' and '2024-12-31' order by p.date;", "intent": "join_splits"}
{"question": "Year-to-date cumulative return for MSI.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MSI' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for AMT between 2024-11-27 and 2025-01-31.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='AMT' and p.date between '2024-11-27' and '2025-01-31' order by p.date;", "intent": "join_dividends"}
{"question": "Year-to-date cumulative return for DE.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='DE' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Split-adjusted close series for PLTR.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='PLTR' order by date;", "intent": "adjusted_price"}
{"question": "Dividend yield TTM time series for BAX.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='BAX' order by date;", "intent": "dividend_yield"}
{"question": "Average close and total volume for sector Technology on 2024-12-24.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-12-24';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for AMZN between 2024-03-21 and 2024-04-02.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='AMZN' and p.date between '2024-03-21' and '2024-04-02' order by p.date;", "intent": "join_splits"}
{"question": "Dividend yield TTM time series for PAYX.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PAYX' order by date;", "intent": "dividend_yield"}
{"question": "Top 10 gainers by daily return on 2024-05-14.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-05-14' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Show OHLCV for DVA on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DVA') select p.* from core.prices_daily p, d where p.ticker='DVA' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Tickers in sector Utilities that traded on 2024-09-06.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-09-06' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Corporate actions for ALL ordered by date.", "sql": "select * from views.corporate_actions where ticker='ALL' order by event_date;", "intent": "corporate_actions"}
{"question": "Top 10 gainers by daily return on 2025-04-25.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-04-25' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Tickers in sector Healthcare that traded on 2025-06-24.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-06-24' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for CMI in 2023-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CMI' and month='2023-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for FDX between 2024-04-08 and 2024-07-02.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='FDX' and p.date between '2024-04-08' and '2024-07-02' order by p.date;", "intent": "join_dividends"}
{"question": "Split-adjusted close series for BA.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='BA' order by date;", "intent": "adjusted_price"}
{"question": "Tickers in sector Consumer Defensive that traded on 2023-11-10.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-11-10' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Utilities that traded on 2025-07-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-07-22' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Corporate actions for VST ordered by date.", "sql": "select * from views.corporate_actions where ticker='VST' order by event_date;", "intent": "corporate_actions"}
{"question": "7-day and 30-day returns for BK.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='BK' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Weekly OHLCV for LH in week 2024-03-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='LH' and week='2024-03-11 00:00:00';", "intent": "resample_weekly"}
{"question": "7-day and 30-day returns for FTV.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='FTV' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and split factors for TJX between 2024-10-16 and 2024-10-23.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='TJX' and p.date between '2024-10-16' and '2024-10-23' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for DLR in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DLR' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Dividend yield TTM time series for CPT.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='CPT' order by date;", "intent": "dividend_yield"}
{"question": "Monthly OHLCV for EXPE in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EXPE' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for GPC in week 2024-12-02 00:00:00.", "sql": "select * from views.prices_weekly where ticker='GPC' and week='2024-12-02 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Communication Services that traded on 2024-12-10.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-12-10' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for CHD in week 2024-07-08 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CHD' and week='2024-07-08 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for HII from 2023-12-21 to 2024-02-12.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HII' and date between '2023-12-21' and '2024-02-12';", "intent": "avg_between_dates"}
{"question": "7-day and 30-day returns for HAL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='HAL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Latest close and volume for PH.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='PH') select date, close, volume from core.prices_daily, mx where ticker='PH' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and split factors for CNP between 2024-09-10 and 2024-11-29.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CNP' and p.date between '2024-09-10' and '2024-11-29' order by p.date;", "intent": "join_splits"}
{"question": "Average close for RL from 2023-12-19 to 2024-01-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='RL' and date between '2023-12-19' and '2024-01-11';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for TMUS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TMUS' order by date;", "intent": "adjusted_price"}
{"question": "Average close for EOG from 2024-05-29 to 2024-08-19.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EOG' and date between '2024-05-29' and '2024-08-19';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Utilities on 2024-01-17.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2024-01-17';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for UPS in week 2025-03-17 00:00:00.", "sql": "select * from views.prices_weekly where ticker='UPS' and week='2025-03-17 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for EPAM in week 2023-12-18 00:00:00.", "sql": "select * from views.prices_weekly where ticker='EPAM' and week='2023-12-18 00:00:00';", "intent": "resample_weekly"}
{"question": "7-day and 30-day returns for PNW.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='PNW' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Split-adjusted close series for FIS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='FIS' order by date;", "intent": "adjusted_price"}
{"question": "Average close and total volume for sector Energy on 2025-02-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2025-02-12';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for SNPS in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SNPS' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for BXP between 2023-11-21 and 2024-01-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='BXP' and p.date between '2023-11-21' and '2024-01-31' order by p.date;", "intent": "join_splits"}
{"question": "Average close for HII from 2025-09-03 to 2025-10-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HII' and date between '2025-09-03' and '2025-10-17';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Real Estate on 2025-08-20.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-08-20';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for KIM in 2025-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='KIM' and month='2025-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for IT including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='IT';", "intent": "profile"}
{"question": "Close price and dividend cash events for NSC between 2024-02-22 and 2024-03-26.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='NSC' and p.date between '2024-02-22' and '2024-03-26' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for DHR between 2024-02-08 and 2024-03-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DHR' and p.date between '2024-02-08' and '2024-03-12' order by p.date;", "intent": "join_splits"}
{"question": "Latest close and volume for MGM.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='MGM') select date, close, volume from core.prices_daily, mx where ticker='MGM' and date=mx.md;", "intent": "latest_point"}
{"question": "Split-adjusted close series for F.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='F' order by date;", "intent": "adjusted_price"}
{"question": "Average close and total volume for sector Industrials on 2024-05-22.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2024-05-22';", "intent": "sector_aggregate"}
{"question": "Average close for GWW from 2025-08-05 to 2025-08-18.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GWW' and date between '2025-08-05' and '2025-08-18';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2024-01-17?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-01-17';", "intent": "calendar_filter"}
{"question": "Company profile for MPWR including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='MPWR';", "intent": "profile"}
{"question": "Monthly OHLCV for FDS in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='FDS' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for INCY ordered by date.", "sql": "select * from views.corporate_actions where ticker='INCY' order by event_date;", "intent": "corporate_actions"}
{"question": "Top 10 gainers by daily return on 2024-01-26.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-01-26' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Show OHLCV for NI on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='NI') select p.* from core.prices_daily p, d where p.ticker='NI' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Dividend yield TTM time series for BK.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='BK' order by date;", "intent": "dividend_yield"}
{"question": "Corporate actions for EXR ordered by date.", "sql": "select * from views.corporate_actions where ticker='EXR' order by event_date;", "intent": "corporate_actions"}
{"question": "Tickers in sector Energy that traded on 2024-05-02.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-05-02' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for DELL in week 2024-12-09 00:00:00.", "sql": "select * from views.prices_weekly where ticker='DELL' and week='2024-12-09 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for LYB in 2024-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='LYB' and month='2024-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for SNA between 2025-08-18 and 2025-10-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='SNA' and p.date between '2025-08-18' and '2025-10-01' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for HPE between 2024-03-18 and 2024-04-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='HPE' and p.date between '2024-03-18' and '2024-04-01' order by p.date;", "intent": "join_splits"}
{"question": "Average close for SPGI from 2025-07-29 to 2025-09-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='SPGI' and date between '2025-07-29' and '2025-09-17';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for ATO.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ATO' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for IRM between 2025-05-28 and 2025-06-09.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IRM' and p.date between '2025-05-28' and '2025-06-09' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for HD in 2024-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='HD' and month='2024-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for DE between 2024-11-06 and 2024-12-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DE' and p.date between '2024-11-06' and '2024-12-12' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for MET between 2024-12-27 and 2025-03-07.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MET' and p.date between '2024-12-27' and '2025-03-07' order by p.date;", "intent": "join_splits"}
{"question": "Latest close and volume for GIS.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='GIS') select date, close, volume from core.prices_daily, mx where ticker='GIS' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for MTCH between 2024-01-04 and 2024-01-25.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MTCH' and p.date between '2024-01-04' and '2024-01-25' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for CTRA.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='CTRA') select date, close, volume from core.prices_daily, mx where ticker='CTRA' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close and total volume for sector Real Estate on 2025-05-20.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-05-20';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2025-03-27.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2025-03-27';", "intent": "sector_aggregate"}
{"question": "Top 10 gainers by daily return on 2025-03-14.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-03-14' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for BDX between 2024-04-23 and 2024-06-12.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='BDX' and p.date between '2024-04-23' and '2024-06-12' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Real Estate on 2023-10-24.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2023-10-24';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for DLR between 2024-02-14 and 2024-02-27.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DLR' and p.date between '2024-02-14' and '2024-02-27' order by p.date;", "intent": "join_splits"}
{"question": "Split-adjusted close series for FAST.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='FAST' order by date;", "intent": "adjusted_price"}
{"question": "Tickers in sector Basic Materials that traded on 2024-03-08.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-08' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Dividend yield TTM time series for J.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='J' order by date;", "intent": "dividend_yield"}
{"question": "Average close and total volume for sector Utilities on 2025-02-27.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2025-02-27';", "intent": "sector_aggregate"}
{"question": "Average close for WRB from 2025-07-28 to 2025-09-09.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='WRB' and date between '2025-07-28' and '2025-09-09';", "intent": "avg_between_dates"}
{"question": "Company profile for CPAY including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CPAY';", "intent": "profile"}
{"question": "Close price and dividend cash events for EL between 2024-04-19 and 2024-06-11.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='EL' and p.date between '2024-04-19' and '2024-06-11' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2023-11-02.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2023-11-02';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Energy that traded on 2025-09-30.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-09-30' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "7-day and 30-day returns for GOOGL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='GOOGL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Latest close and volume for BDX.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='BDX') select date, close, volume from core.prices_daily, mx where ticker='BDX' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for FICO in week 2024-03-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='FICO' and week='2024-03-11 00:00:00';", "intent": "resample_weekly"}
{"question": "Top 10 gainers by daily return on 2024-05-06.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-05-06' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for LMT between 2025-04-08 and 2025-06-30.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LMT' and p.date between '2025-04-08' and '2025-06-30' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for KMX between 2024-09-05 and 2024-10-07.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KMX' and p.date between '2024-09-05' and '2024-10-07' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for MA between 2025-03-06 and 2025-03-28.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MA' and p.date between '2025-03-06' and '2025-03-28' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Basic Materials that traded on 2024-02-26.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-02-26' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Split-adjusted close series for EXR.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='EXR' order by date;", "intent": "adjusted_price"}
{"question": "Company profile for AMT including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='AMT';", "intent": "profile"}
{"question": "7-day and 30-day returns for XOM.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='XOM' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Top 10 gainers by daily return on 2024-09-11.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-09-11' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for CZR between 2025-09-03 and 2025-09-16.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CZR' and p.date between '2025-09-03' and '2025-09-16' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Industrials on 2025-10-14.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2025-10-14';", "intent": "sector_aggregate"}
{"question": "Top 10 gainers by daily return on 2025-05-28.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-05-28' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Corporate actions for DUK ordered by date.", "sql": "select * from views.corporate_actions where ticker='DUK' order by event_date;", "intent": "corporate_actions"}
{"question": "Dividend yield TTM time series for DECK.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='DECK' order by date;", "intent": "dividend_yield"}
{"question": "Was NYSE open on 2023-11-16?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-11-16';", "intent": "calendar_filter"}
{"question": "Average close and total volume for sector Communication Services on 2024-12-23.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-12-23';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for PRU in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PRU' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Top 10 gainers by daily return on 2024-03-25.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-03-25' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Split-adjusted close series for MS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MS' order by date;", "intent": "adjusted_price"}
{"question": "Monthly OHLCV for ETR in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ETR' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for WFC between 2024-12-13 and 2025-02-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='WFC' and p.date between '2024-12-13' and '2025-02-12' order by p.date;", "intent": "join_splits"}
{"question": "Average close for PFE from 2025-09-22 to 2025-10-01.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PFE' and date between '2025-09-22' and '2025-10-01';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for JNJ between 2025-06-05 and 2025-06-26.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='JNJ' and p.date between '2025-06-05' and '2025-06-26' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2025-04-23?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-04-23';", "intent": "calendar_filter"}
{"question": "7-day and 30-day returns for KVUE.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='KVUE' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Top 10 gainers by daily return on 2025-09-24.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-09-24' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for HIG in week 2024-12-09 00:00:00.", "sql": "select * from views.prices_weekly where ticker='HIG' and week='2024-12-09 00:00:00';", "intent": "resample_weekly"}
{"question": "Latest close and volume for MSI.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='MSI') select date, close, volume from core.prices_daily, mx where ticker='MSI' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for AEE between 2024-06-17 and 2024-08-27.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='AEE' and p.date between '2024-06-17' and '2024-08-27' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2025-02-18?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-02-18';", "intent": "calendar_filter"}
{"question": "Top 10 gainers by daily return on 2025-09-11.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-09-11' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and split factors for MPC between 2025-01-16 and 2025-02-28.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MPC' and p.date between '2025-01-16' and '2025-02-28' order by p.date;", "intent": "join_splits"}
{"question": "Top 10 gainers by daily return on 2025-03-19.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-03-19' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Was NYSE open on 2024-07-15?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-07-15';", "intent": "calendar_filter"}
{"question": "Close price and dividend cash events for IRM between 2023-11-13 and 2024-01-04.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IRM' and p.date between '2023-11-13' and '2024-01-04' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2025-07-10?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-07-10';", "intent": "calendar_filter"}
{"question": "Corporate actions for TSLA ordered by date.", "sql": "select * from views.corporate_actions where ticker='TSLA' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for DRI in 2025-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DRI' and month='2025-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for FDX in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='FDX' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Show OHLCV for LKQ on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='LKQ') select p.* from core.prices_daily p, d where p.ticker='LKQ' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for INVH in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='INVH' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for RF between 2024-07-11 and 2024-10-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='RF' and p.date between '2024-07-11' and '2024-10-31' order by p.date;", "intent": "join_splits"}
{"question": "Show OHLCV for DHI on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DHI') select p.* from core.prices_daily p, d where p.ticker='DHI' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Split-adjusted close series for HUBB.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='HUBB' order by date;", "intent": "adjusted_price"}
{"question": "Monthly OHLCV for FRT in 2024-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='FRT' and month='2024-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for CVS including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CVS';", "intent": "profile"}
{"question": "Monthly OHLCV for DE in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DE' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for CLX.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CLX' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for IRM between 2025-04-25 and 2025-06-12.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IRM' and p.date between '2025-04-25' and '2025-06-12' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for PEG in 2024-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PEG' and month='2024-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for RJF.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='RJF' order by date;", "intent": "adjusted_price"}
{"question": "Show OHLCV for ALGN on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='ALGN') select p.* from core.prices_daily p, d where p.ticker='ALGN' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Dividend yield TTM time series for PEG.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PEG' order by date;", "intent": "dividend_yield"}
{"question": "Monthly OHLCV for DVA in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DVA' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for CBOE.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CBOE' order by date;", "intent": "adjusted_price"}
{"question": "Average close and total volume for sector Healthcare on 2024-02-02.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-02-02';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for DHI in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DHI' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Energy that traded on 2023-10-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-10-27' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for ODFL between 2025-02-20 and 2025-03-12.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ODFL' and p.date between '2025-02-20' and '2025-03-12' order by p.date;", "intent": "join_dividends"}
{"question": "Dividend yield TTM time series for INTU.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='INTU' order by date;", "intent": "dividend_yield"}
{"question": "Year-to-date cumulative return for PNW.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='PNW' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Was NYSE open on 2025-04-22?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-04-22';", "intent": "calendar_filter"}
{"question": "Dividend yield TTM time series for CTAS.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='CTAS' order by date;", "intent": "dividend_yield"}
{"question": "Dividend yield TTM time series for WAT.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='WAT' order by date;", "intent": "dividend_yield"}
{"question": "Weekly OHLCV for AMZN in week 2024-05-20 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AMZN' and week='2024-05-20 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for IT from 2024-01-02 to 2024-02-14.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='IT' and date between '2024-01-02' and '2024-02-14';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for IEX in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='IEX' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Dividend yield TTM time series for VST.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='VST' order by date;", "intent": "dividend_yield"}
{"question": "Average close for ED from 2025-01-31 to 2025-02-25.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ED' and date between '2025-01-31' and '2025-02-25';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for GEN between 2024-09-18 and 2024-10-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GEN' and p.date between '2024-09-18' and '2024-10-17' order by p.date;", "intent": "join_dividends"}
{"question": "Company profile for CRM including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CRM';", "intent": "profile"}
{"question": "Close price and split factors for DOC between 2024-01-26 and 2024-02-22.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DOC' and p.date between '2024-01-26' and '2024-02-22' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for TDY in week 2024-11-18 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TDY' and week='2024-11-18 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for ETR between 2024-07-08 and 2024-08-02.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ETR' and p.date between '2024-07-08' and '2024-08-02' order by p.date;", "intent": "join_dividends"}
{"question": "Top 10 gainers by daily return on 2024-04-19.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-04-19' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Was NYSE open on 2024-01-02?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-01-02';", "intent": "calendar_filter"}
{"question": "Average close and total volume for sector Consumer Defensive on 2024-07-09.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2024-07-09';", "intent": "sector_aggregate"}
{"question": "Company profile for CAG including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CAG';", "intent": "profile"}
{"question": "Close price and dividend cash events for LYV between 2024-10-15 and 2024-10-29.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LYV' and p.date between '2024-10-15' and '2024-10-29' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2024-02-05?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-02-05';", "intent": "calendar_filter"}
{"question": "Average close for CINF from 2024-08-06 to 2024-08-20.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CINF' and date between '2024-08-06' and '2024-08-20';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for DAY in week 2025-02-17 00:00:00.", "sql": "select * from views.prices_weekly where ticker='DAY' and week='2025-02-17 00:00:00';", "intent": "resample_weekly"}
{"question": "Top 10 gainers by daily return on 2025-09-12.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-09-12' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Year-to-date cumulative return for TMO.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='TMO' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for WYNN in week 2024-02-19 00:00:00.", "sql": "select * from views.prices_weekly where ticker='WYNN' and week='2024-02-19 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-08-09.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-09' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for ABNB.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='ABNB') select date, close, volume from core.prices_daily, mx where ticker='ABNB' and date=mx.md;", "intent": "latest_point"}
{"question": "Corporate actions for VTR ordered by date.", "sql": "select * from views.corporate_actions where ticker='VTR' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and split factors for PPL between 2024-04-16 and 2024-07-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PPL' and p.date between '2024-04-16' and '2024-07-01' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for TGT in 2025-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TGT' and month='2025-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "7-day and 30-day returns for LVS.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='LVS' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Corporate actions for PLTR ordered by date.", "sql": "select * from views.corporate_actions where ticker='PLTR' order by event_date;", "intent": "corporate_actions"}
{"question": "Was NYSE open on 2024-04-02?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-04-02';", "intent": "calendar_filter"}
{"question": "Show OHLCV for REG on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='REG') select p.* from core.prices_daily p, d where p.ticker='REG' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for VRSK between 2023-12-06 and 2024-02-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='VRSK' and p.date between '2023-12-06' and '2024-02-01' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Basic Materials on 2024-04-09.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-04-09';", "intent": "sector_aggregate"}
{"question": "Latest close and volume for INTC.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='INTC') select date, close, volume from core.prices_daily, mx where ticker='INTC' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for MAA in week 2024-07-08 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MAA' and week='2024-07-08 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for AAPL in week 2024-05-27 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AAPL' and week='2024-05-27 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Utilities that traded on 2025-02-07.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-02-07' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Energy on 2024-10-03.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2024-10-03';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for CTRA in 2024-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CTRA' and month='2024-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for FMC in 2024-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='FMC' and month='2024-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for GPC between 2024-07-31 and 2024-08-30.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GPC' and p.date between '2024-07-31' and '2024-08-30' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Basic Materials that traded on 2025-02-07.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-02-07' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for CHD between 2025-07-29 and 2025-08-11.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CHD' and p.date between '2025-07-29' and '2025-08-11' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for EA between 2024-06-24 and 2024-07-09.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='EA' and p.date between '2024-06-24' and '2024-07-09' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for HSIC in 2024-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='HSIC' and month='2024-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close for WEC from 2024-03-22 to 2024-04-18.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='WEC' and date between '2024-03-22' and '2024-04-18';", "intent": "avg_between_dates"}
{"question": "Average close for O from 2024-02-22 to 2024-03-19.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='O' and date between '2024-02-22' and '2024-03-19';", "intent": "avg_between_dates"}
{"question": "Year-to-date cumulative return for OXY.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='OXY' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for HLT between 2025-02-24 and 2025-03-07.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='HLT' and p.date between '2025-02-24' and '2025-03-07' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for PHM between 2024-03-19 and 2024-05-02.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PHM' and p.date between '2024-03-19' and '2024-05-02' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Financial Services that traded on 2025-07-18.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-07-18' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Energy on 2024-04-11.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2024-04-11';", "intent": "sector_aggregate"}
{"question": "Show OHLCV for MPWR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='MPWR') select p.* from core.prices_daily p, d where p.ticker='MPWR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for WFC between 2025-05-20 and 2025-05-28.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='WFC' and p.date between '2025-05-20' and '2025-05-28' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for INVH between 2024-06-14 and 2024-06-25.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='INVH' and p.date between '2024-06-14' and '2024-06-25' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Real Estate on 2025-06-26.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-06-26';", "intent": "sector_aggregate"}
{"question": "Average close for EXPD from 2025-04-24 to 2025-05-14.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EXPD' and date between '2025-04-24' and '2025-05-14';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for IBM.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='IBM' order by date;", "intent": "adjusted_price"}
{"question": "Latest close and volume for QCOM.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='QCOM') select date, close, volume from core.prices_daily, mx where ticker='QCOM' and date=mx.md;", "intent": "latest_point"}
{"question": "Year-to-date cumulative return for A.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='A' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Top 10 gainers by daily return on 2024-10-01.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-10-01' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Split-adjusted close series for CSGP.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CSGP' order by date;", "intent": "adjusted_price"}
{"question": "Close price and split factors for ABNB between 2023-12-06 and 2023-12-21.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ABNB' and p.date between '2023-12-06' and '2023-12-21' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for SNA between 2024-07-25 and 2024-08-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='SNA' and p.date between '2024-07-25' and '2024-08-01' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for XOM in 2025-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='XOM' and month='2025-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for PCAR between 2024-03-25 and 2024-04-04.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PCAR' and p.date between '2024-03-25' and '2024-04-04' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for CTVA in 2024-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CTVA' and month='2024-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for WELL ordered by date.", "sql": "select * from views.corporate_actions where ticker='WELL' order by event_date;", "intent": "corporate_actions"}
{"question": "Weekly OHLCV for EOG in week 2024-01-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='EOG' and week='2024-01-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for TXT in 2025-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TXT' and month='2025-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Communication Services on 2023-12-07.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2023-12-07';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for CVS between 2024-03-18 and 2024-05-13.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CVS' and p.date between '2024-03-18' and '2024-05-13' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for BAX between 2025-08-06 and 2025-08-13.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='BAX' and p.date between '2025-08-06' and '2025-08-13' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for BIIB between 2025-07-18 and 2025-08-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='BIIB' and p.date between '2025-07-18' and '2025-08-12' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for MRK between 2025-04-17 and 2025-05-23.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MRK' and p.date between '2025-04-17' and '2025-05-23' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Industrials on 2023-12-28.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2023-12-28';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for EXPE in week 2024-02-26 00:00:00.", "sql": "select * from views.prices_weekly where ticker='EXPE' and week='2024-02-26 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and split factors for UHS between 2024-05-14 and 2024-05-29.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='UHS' and p.date between '2024-05-14' and '2024-05-29' order by p.date;", "intent": "join_splits"}
{"question": "Year-to-date cumulative return for CMS.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CMS' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "7-day and 30-day returns for RSG.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='RSG' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Tickers in sector Financial Services that traded on 2023-12-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-12-22' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2025-07-08.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-07-08' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for MNST in week 2025-04-28 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MNST' and week='2025-04-28 00:00:00';", "intent": "resample_weekly"}
{"question": "Was NYSE open on 2024-01-29?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-01-29';", "intent": "calendar_filter"}
{"question": "Company profile for MGM including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='MGM';", "intent": "profile"}
{"question": "7-day and 30-day returns for MOH.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='MOH' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close for BSX from 2025-04-25 to 2025-05-05.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='BSX' and date between '2025-04-25' and '2025-05-05';", "intent": "avg_between_dates"}
{"question": "Show OHLCV for SLB on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='SLB') select p.* from core.prices_daily p, d where p.ticker='SLB' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Was NYSE open on 2024-07-16?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-07-16';", "intent": "calendar_filter"}
{"question": "Top 10 gainers by daily return on 2025-06-27.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-06-27' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Show OHLCV for DXCM on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DXCM') select p.* from core.prices_daily p, d where p.ticker='DXCM' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Was NYSE open on 2024-12-13?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-12-13';", "intent": "calendar_filter"}
{"question": "Year-to-date cumulative return for RVTY.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='RVTY' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Split-adjusted close series for EXC.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='EXC' order by date;", "intent": "adjusted_price"}
{"question": "Close price and split factors for KEYS between 2025-05-13 and 2025-05-29.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KEYS' and p.date between '2025-05-13' and '2025-05-29' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for ABNB in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ABNB' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for TSCO.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TSCO' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for OXY between 2025-05-14 and 2025-07-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='OXY' and p.date between '2025-05-14' and '2025-07-17' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for NSC in week 2025-04-28 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NSC' and week='2025-04-28 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for CME including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CME';", "intent": "profile"}
{"question": "Monthly OHLCV for NCLH in 2025-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NCLH' and month='2025-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Was NYSE open on 2024-12-26?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-12-26';", "intent": "calendar_filter"}
{"question": "Split-adjusted close series for BWA.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='BWA' order by date;", "intent": "adjusted_price"}
{"question": "Latest close and volume for WDC.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='WDC') select date, close, volume from core.prices_daily, mx where ticker='WDC' and date=mx.md;", "intent": "latest_point"}
{"question": "Top 10 gainers by daily return on 2025-01-07.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-01-07' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Dividend yield TTM time series for TPL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='TPL' order by date;", "intent": "dividend_yield"}
{"question": "Close price and split factors for FDX between 2025-03-19 and 2025-05-29.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='FDX' and p.date between '2025-03-19' and '2025-05-29' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for DGX in week 2024-07-29 00:00:00.", "sql": "select * from views.prices_weekly where ticker='DGX' and week='2024-07-29 00:00:00';", "intent": "resample_weekly"}
{"question": "Dividend yield TTM time series for ODFL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='ODFL' order by date;", "intent": "dividend_yield"}
{"question": "Was NYSE open on 2025-10-02?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-10-02';", "intent": "calendar_filter"}
{"question": "Was NYSE open on 2025-05-13?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-05-13';", "intent": "calendar_filter"}
{"question": "Weekly OHLCV for CPB in week 2024-08-05 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CPB' and week='2024-08-05 00:00:00';", "intent": "resample_weekly"}
{"question": "Latest close and volume for AMD.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AMD') select date, close, volume from core.prices_daily, mx where ticker='AMD' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and split factors for AFL between 2023-12-04 and 2024-01-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='AFL' and p.date between '2023-12-04' and '2024-01-31' order by p.date;", "intent": "join_splits"}

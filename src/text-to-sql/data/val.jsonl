{"question": "Monthly OHLCV for APH in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='APH' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for NUE between 2025-05-20 and 2025-08-22.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='NUE' and p.date between '2025-05-20' and '2025-08-22' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Basic Materials on 2024-03-20.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-03-20';", "intent": "sector_aggregate"}
{"question": "Show OHLCV for UBER on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='UBER') select p.* from core.prices_daily p, d where p.ticker='UBER' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close for HON from 2024-04-12 to 2024-05-10.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HON' and date between '2024-04-12' and '2024-05-10';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2025-04-29?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-04-29';", "intent": "calendar_filter"}
{"question": "Close price and split factors for OMC between 2023-10-26 and 2023-12-05.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='OMC' and p.date between '2023-10-26' and '2023-12-05' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for TXT in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TXT' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for EXC in week 2023-10-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='EXC' and week='2023-10-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for RJF in week 2025-07-07 00:00:00.", "sql": "select * from views.prices_weekly where ticker='RJF' and week='2025-07-07 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for C on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='C') select p.* from core.prices_daily p, d where p.ticker='C' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Dividend yield TTM time series for EQR.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='EQR' order by date;", "intent": "dividend_yield"}
{"question": "Close price and split factors for ROST between 2025-06-13 and 2025-07-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ROST' and p.date between '2025-06-13' and '2025-07-01' order by p.date;", "intent": "join_splits"}
{"question": "Split-adjusted close series for PHM.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='PHM' order by date;", "intent": "adjusted_price"}
{"question": "Average close and total volume for sector Energy on 2025-07-24.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2025-07-24';", "intent": "sector_aggregate"}
{"question": "Average close for OKE from 2025-08-25 to 2025-09-25.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='OKE' and date between '2025-08-25' and '2025-09-25';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for MGM.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='MGM' order by date;", "intent": "dividend_yield"}
{"question": "Close price and dividend cash events for EXR between 2024-10-03 and 2024-10-16.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='EXR' and p.date between '2024-10-03' and '2024-10-16' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for MLM on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='MLM') select p.* from core.prices_daily p, d where p.ticker='MLM' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close for APH from 2025-05-14 to 2025-06-09.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='APH' and date between '2025-05-14' and '2025-06-09';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for O.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='O' order by date;", "intent": "dividend_yield"}
{"question": "Year-to-date cumulative return for COO.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='COO' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Split-adjusted close series for SCHW.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='SCHW' order by date;", "intent": "adjusted_price"}
{"question": "Average close for NVDA from 2023-10-31 to 2023-11-20.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='NVDA' and date between '2023-10-31' and '2023-11-20';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for RSG in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='RSG' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for ORCL in 2025-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ORCL' and month='2025-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for ROST in week 2025-01-13 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ROST' and week='2025-01-13 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for EPAM on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='EPAM') select p.* from core.prices_daily p, d where p.ticker='EPAM' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Weekly OHLCV for DTE in week 2024-07-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='DTE' and week='2024-07-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Dividend yield TTM time series for ICE.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='ICE' order by date;", "intent": "dividend_yield"}
{"question": "Average close for ROK from 2023-11-30 to 2024-01-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ROK' and date between '2023-11-30' and '2024-01-17';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for NEE between 2025-03-07 and 2025-04-28.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='NEE' and p.date between '2025-03-07' and '2025-04-28' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for BDX between 2025-04-14 and 2025-04-23.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='BDX' and p.date between '2025-04-14' and '2025-04-23' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for DUK from 2024-12-23 to 2025-02-18.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DUK' and date between '2024-12-23' and '2025-02-18';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Technology that traded on 2025-02-06.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-02-06' and t.sector='Technology' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Technology on 2024-10-17.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-10-17';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Real Estate on 2025-03-05.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-03-05';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for FCX between 2025-09-05 and 2025-09-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='FCX' and p.date between '2025-09-05' and '2025-09-16' order by p.date;", "intent": "join_splits"}
{"question": "Average close for CRWD from 2024-11-15 to 2024-11-27.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CRWD' and date between '2024-11-15' and '2024-11-27';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for NI in week 2023-11-27 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NI' and week='2023-11-27 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for PEP in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PEP' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for PNW in 2024-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PNW' and month='2024-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Basic Materials on 2025-07-23.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2025-07-23';", "intent": "sector_aggregate"}
{"question": "Split-adjusted close series for HWM.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='HWM' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for BR between 2024-10-21 and 2024-11-05.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='BR' and p.date between '2024-10-21' and '2024-11-05' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for CSX in 2023-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CSX' and month='2023-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for HON ordered by date.", "sql": "select * from views.corporate_actions where ticker='HON' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for AJG in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='AJG' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close for TMO from 2025-07-17 to 2025-09-09.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='TMO' and date between '2025-07-17' and '2025-09-09';", "intent": "avg_between_dates"}
{"question": "Latest close and volume for TGT.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='TGT') select date, close, volume from core.prices_daily, mx where ticker='TGT' and date=mx.md;", "intent": "latest_point"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-02-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-02-27' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for DOW between 2025-08-13 and 2025-08-21.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='DOW' and p.date between '2025-08-13' and '2025-08-21' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for ELV in 2025-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ELV' and month='2025-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for MHK between 2024-03-21 and 2024-06-04.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MHK' and p.date between '2024-03-21' and '2024-06-04' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Basic Materials on 2024-06-20.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-06-20';", "intent": "sector_aggregate"}
{"question": "Split-adjusted close series for EMR.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='EMR' order by date;", "intent": "adjusted_price"}
{"question": "Dividend yield TTM time series for HPQ.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='HPQ' order by date;", "intent": "dividend_yield"}
{"question": "Average close for HAL from 2024-02-23 to 2024-03-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HAL' and date between '2024-02-23' and '2024-03-11';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for NWSA in 2025-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NWSA' and month='2025-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for MCK between 2025-05-06 and 2025-06-17.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MCK' and p.date between '2025-05-06' and '2025-06-17' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for NVR between 2024-11-01 and 2025-01-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='NVR' and p.date between '2024-11-01' and '2025-01-31' order by p.date;", "intent": "join_splits"}
{"question": "Company profile for ADSK including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='ADSK';", "intent": "profile"}
{"question": "Average close for HRL from 2025-09-05 to 2025-10-01.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HRL' and date between '2025-09-05' and '2025-10-01';", "intent": "avg_between_dates"}
{"question": "Average close for KIM from 2024-07-09 to 2024-07-23.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='KIM' and date between '2024-07-09' and '2024-07-23';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for VICI.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='VICI' order by date;", "intent": "dividend_yield"}
{"question": "Tickers in sector Industrials that traded on 2025-05-28.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-05-28' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "7-day and 30-day returns for PPG.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='PPG' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Split-adjusted close series for MAR.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MAR' order by date;", "intent": "adjusted_price"}
{"question": "Average close and total volume for sector Healthcare on 2024-08-16.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-08-16';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for CINF in week 2024-12-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CINF' and week='2024-12-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for PNW from 2025-04-07 to 2025-06-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PNW' and date between '2025-04-07' and '2025-06-17';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for D.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='D' order by date;", "intent": "dividend_yield"}
{"question": "Latest close and volume for MPC.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='MPC') select date, close, volume from core.prices_daily, mx where ticker='MPC' and date=mx.md;", "intent": "latest_point"}
{"question": "Tickers in sector Technology that traded on 2024-10-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-10-22' and t.sector='Technology' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for WAT between 2024-03-18 and 2024-04-03.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='WAT' and p.date between '2024-03-18' and '2024-04-03' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Basic Materials that traded on 2023-11-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-11-27' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for CTVA in week 2025-08-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CTVA' and week='2025-08-11 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for EBAY.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='EBAY' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for MAA in week 2023-11-06 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MAA' and week='2023-11-06 00:00:00';", "intent": "resample_weekly"}
{"question": "Was NYSE open on 2025-10-09?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-10-09';", "intent": "calendar_filter"}
{"question": "Close price and dividend cash events for NEM between 2025-09-19 and 2025-10-15.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='NEM' and p.date between '2025-09-19' and '2025-10-15' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Energy that traded on 2025-08-29.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-08-29' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2024-01-12.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-01-12' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Tickers in sector Energy that traded on 2025-04-15.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-04-15' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for ARE in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ARE' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for GOOG.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='GOOG') select date, close, volume from core.prices_daily, mx where ticker='GOOG' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for NUE between 2025-03-12 and 2025-06-06.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='NUE' and p.date between '2025-03-12' and '2025-06-06' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for IBM.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='IBM') select date, close, volume from core.prices_daily, mx where ticker='IBM' and date=mx.md;", "intent": "latest_point"}
{"question": "Tickers in sector Utilities that traded on 2023-12-07.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-12-07' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for RVTY in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='RVTY' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for UNP.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='UNP') select date, close, volume from core.prices_daily, mx where ticker='UNP' and date=mx.md;", "intent": "latest_point"}
{"question": "Company profile for LDOS including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='LDOS';", "intent": "profile"}
{"question": "Split-adjusted close series for ORCL.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ORCL' order by date;", "intent": "adjusted_price"}
{"question": "Was NYSE open on 2023-11-08?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-11-08';", "intent": "calendar_filter"}
{"question": "Latest close and volume for GE.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='GE') select date, close, volume from core.prices_daily, mx where ticker='GE' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for CTRA in week 2024-01-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CTRA' and week='2024-01-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Latest close and volume for AAPL.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AAPL') select date, close, volume from core.prices_daily, mx where ticker='AAPL' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for BR in week 2025-07-07 00:00:00.", "sql": "select * from views.prices_weekly where ticker='BR' and week='2025-07-07 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for KEY in week 2024-05-13 00:00:00.", "sql": "select * from views.prices_weekly where ticker='KEY' and week='2024-05-13 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for PTC on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='PTC') select p.* from core.prices_daily p, d where p.ticker='PTC' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Year-to-date cumulative return for AMP.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='AMP' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for PGR in week 2023-12-04 00:00:00.", "sql": "select * from views.prices_weekly where ticker='PGR' and week='2023-12-04 00:00:00';", "intent": "resample_weekly"}
{"question": "Corporate actions for IVZ ordered by date.", "sql": "select * from views.corporate_actions where ticker='IVZ' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Basic Materials on 2025-07-31.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2025-07-31';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for UAL in week 2024-01-01 00:00:00.", "sql": "select * from views.prices_weekly where ticker='UAL' and week='2024-01-01 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for HAS on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='HAS') select p.* from core.prices_daily p, d where p.ticker='HAS' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Was NYSE open on 2025-03-07?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-03-07';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for CBRE in 2024-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CBRE' and month='2024-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for INCY in 2025-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='INCY' and month='2025-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Was NYSE open on 2025-08-18?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-08-18';", "intent": "calendar_filter"}
{"question": "Average close for LEN from 2023-12-26 to 2024-01-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='LEN' and date between '2023-12-26' and '2024-01-26';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2024-08-16?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-08-16';", "intent": "calendar_filter"}
{"question": "Tickers in sector Healthcare that traded on 2023-11-27.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-11-27' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Average close for OMC from 2024-12-18 to 2025-02-05.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='OMC' and date between '2024-12-18' and '2025-02-05';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for XEL between 2025-02-27 and 2025-04-28.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='XEL' and p.date between '2025-02-27' and '2025-04-28' order by p.date;", "intent": "join_dividends"}
{"question": "Company profile for BWA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='BWA';", "intent": "profile"}
{"question": "Tickers in sector Real Estate that traded on 2024-03-05.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-05' and t.sector='Real Estate' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for VICI.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='VICI') select date, close, volume from core.prices_daily, mx where ticker='VICI' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for CPT from 2024-11-26 to 2025-01-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CPT' and date between '2024-11-26' and '2025-01-21';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for MCO.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MCO' order by date;", "intent": "adjusted_price"}
{"question": "Average close for COF from 2025-05-01 to 2025-05-09.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='COF' and date between '2025-05-01' and '2025-05-09';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Communication Services on 2025-10-08.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2025-10-08';", "intent": "sector_aggregate"}
{"question": "Show OHLCV for CDW on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='CDW') select p.* from core.prices_daily p, d where p.ticker='CDW' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Dividend yield TTM time series for WST.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='WST' order by date;", "intent": "dividend_yield"}
{"question": "Year-to-date cumulative return for IBM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='IBM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Dividend yield TTM time series for PTC.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PTC' order by date;", "intent": "dividend_yield"}
{"question": "Close price and split factors for HBAN between 2023-11-06 and 2023-11-27.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='HBAN' and p.date between '2023-11-06' and '2023-11-27' order by p.date;", "intent": "join_splits"}
{"question": "Top 10 gainers by daily return on 2024-07-01.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-07-01' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Split-adjusted close series for INTU.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='INTU' order by date;", "intent": "adjusted_price"}
{"question": "Company profile for HRL including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='HRL';", "intent": "profile"}
{"question": "Close price and dividend cash events for ADM between 2024-10-23 and 2024-11-04.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ADM' and p.date between '2024-10-23' and '2024-11-04' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for ALL from 2024-05-13 to 2024-08-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ALL' and date between '2024-05-13' and '2024-08-21';", "intent": "avg_between_dates"}
{"question": "Close price and split factors for USB between 2025-07-07 and 2025-08-04.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='USB' and p.date between '2025-07-07' and '2025-08-04' order by p.date;", "intent": "join_splits"}
{"question": "Corporate actions for BEN ordered by date.", "sql": "select * from views.corporate_actions where ticker='BEN' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and dividend cash events for DE between 2024-06-11 and 2024-07-25.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='DE' and p.date between '2024-06-11' and '2024-07-25' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for CSCO in week 2024-06-17 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CSCO' and week='2024-06-17 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for LEN including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='LEN';", "intent": "profile"}
{"question": "Monthly OHLCV for CCL in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CCL' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for EVRG between 2025-05-23 and 2025-07-17.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='EVRG' and p.date between '2025-05-23' and '2025-07-17' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for CPB in week 2025-09-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CPB' and week='2025-09-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for POOL including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='POOL';", "intent": "profile"}
{"question": "Monthly OHLCV for EBAY in 2025-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EBAY' and month='2025-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for SNPS.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='SNPS' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Tickers in sector Communication Services that traded on 2025-04-16.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-04-16' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for KO between 2024-02-29 and 2024-03-11.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='KO' and p.date between '2024-02-29' and '2024-03-11' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for SYK.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='SYK') select date, close, volume from core.prices_daily, mx where ticker='SYK' and date=mx.md;", "intent": "latest_point"}
{"question": "Corporate actions for PH ordered by date.", "sql": "select * from views.corporate_actions where ticker='PH' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and split factors for CTSH between 2023-11-27 and 2023-12-06.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CTSH' and p.date between '2023-11-27' and '2023-12-06' order by p.date;", "intent": "join_splits"}
{"question": "Year-to-date cumulative return for MHK.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MHK' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Company profile for SJM including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='SJM';", "intent": "profile"}
{"question": "Tickers in sector Real Estate that traded on 2024-10-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-10-22' and t.sector='Real Estate' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for ADBE.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='ADBE') select date, close, volume from core.prices_daily, mx where ticker='ADBE' and date=mx.md;", "intent": "latest_point"}
{"question": "Split-adjusted close series for MHK.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MHK' order by date;", "intent": "adjusted_price"}
{"question": "Latest close and volume for EOG.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='EOG') select date, close, volume from core.prices_daily, mx where ticker='EOG' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for CI from 2025-01-28 to 2025-03-27.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CI' and date between '2025-01-28' and '2025-03-27';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for INCY between 2024-11-07 and 2024-12-09.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='INCY' and p.date between '2024-11-07' and '2024-12-09' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2024-04-08?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-04-08';", "intent": "calendar_filter"}
{"question": "Average close for GE from 2024-10-25 to 2024-11-19.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GE' and date between '2024-10-25' and '2024-11-19';", "intent": "avg_between_dates"}
{"question": "7-day and 30-day returns for AXP.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='AXP' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Show OHLCV for HPE on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='HPE') select p.* from core.prices_daily p, d where p.ticker='HPE' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Top 10 gainers by daily return on 2024-04-29.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-04-29' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Monthly OHLCV for SYK in 2025-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='SYK' and month='2025-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for ATO in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ATO' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for JBL between 2024-07-11 and 2024-09-11.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='JBL' and p.date between '2024-07-11' and '2024-09-11' order by p.date;", "intent": "join_splits"}
{"question": "Was NYSE open on 2025-09-18?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-09-18';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for MPC in 2025-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MPC' and month='2025-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for GD between 2024-09-05 and 2024-11-01.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GD' and p.date between '2024-09-05' and '2024-11-01' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for VTR in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='VTR' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Top 10 gainers by daily return on 2024-05-09.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-05-09' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "7-day and 30-day returns for CHD.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='CHD' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and dividend cash events for V between 2024-02-13 and 2024-04-16.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='V' and p.date between '2024-02-13' and '2024-04-16' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for DHR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DHR') select p.* from core.prices_daily p, d where p.ticker='DHR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close and total volume for sector Healthcare on 2024-09-19.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-09-19';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for PCG in week 2024-03-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='PCG' and week='2024-03-11 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for PHM from 2025-04-24 to 2025-07-14.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PHM' and date between '2025-04-24' and '2025-07-14';", "intent": "avg_between_dates"}
{"question": "Year-to-date cumulative return for GDDY.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='GDDY' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Split-adjusted close series for TXN.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TXN' order by date;", "intent": "adjusted_price"}
{"question": "Weekly OHLCV for MKC in week 2024-10-07 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MKC' and week='2024-10-07 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Basic Materials on 2025-08-13.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2025-08-13';", "intent": "sector_aggregate"}
{"question": "Average close for HD from 2024-03-05 to 2024-04-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HD' and date between '2024-03-05' and '2024-04-26';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for PFG in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PFG' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Healthcare that traded on 2024-01-08.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-01-08' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Show OHLCV for HUM on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='HUM') select p.* from core.prices_daily p, d where p.ticker='HUM' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for PEG between 2025-08-11 and 2025-08-26.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PEG' and p.date between '2025-08-11' and '2025-08-26' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Utilities that traded on 2025-08-18.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-08-18' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Year-to-date cumulative return for SBUX.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='SBUX' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Was NYSE open on 2025-08-20?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-08-20';", "intent": "calendar_filter"}
{"question": "Weekly OHLCV for KHC in week 2023-11-13 00:00:00.", "sql": "select * from views.prices_weekly where ticker='KHC' and week='2023-11-13 00:00:00';", "intent": "resample_weekly"}
{"question": "Was NYSE open on 2025-03-24?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-03-24';", "intent": "calendar_filter"}
{"question": "Average close for EXPD from 2025-02-12 to 2025-05-13.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EXPD' and date between '2025-02-12' and '2025-05-13';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Healthcare on 2024-07-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-07-12';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for ICE between 2024-11-07 and 2024-11-18.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ICE' and p.date between '2024-11-07' and '2024-11-18' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for CF from 2024-01-16 to 2024-01-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CF' and date between '2024-01-16' and '2024-01-26';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Consumer Defensive that traded on 2025-01-23.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-01-23' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for SHW between 2025-02-19 and 2025-03-03.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='SHW' and p.date between '2025-02-19' and '2025-03-03' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for TER in week 2024-12-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TER' and week='2024-12-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for CINF including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CINF';", "intent": "profile"}
{"question": "Year-to-date cumulative return for SLB.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='SLB' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Monthly OHLCV for EA in 2024-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EA' and month='2024-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for MRK in week 2023-12-11 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MRK' and week='2023-12-11 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Consumer Defensive that traded on 2025-07-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-07-22' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for GD between 2025-04-28 and 2025-07-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GD' and p.date between '2025-04-28' and '2025-07-17' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for IR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='IR') select p.* from core.prices_daily p, d where p.ticker='IR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Top 10 gainers by daily return on 2025-05-13.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-05-13' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Latest close and volume for STT.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='STT') select date, close, volume from core.prices_daily, mx where ticker='STT' and date=mx.md;", "intent": "latest_point"}
{"question": "Monthly OHLCV for AMD in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='AMD' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for WAT in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='WAT' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for EW in 2024-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EW' and month='2024-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Utilities on 2024-09-06.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2024-09-06';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Industrials that traded on 2024-01-11.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-01-11' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2025-02-14.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-02-14' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and split factors for ALB between 2024-11-21 and 2024-12-09.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ALB' and p.date between '2024-11-21' and '2024-12-09' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for NOW in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NOW' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Was NYSE open on 2023-12-27?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-12-27';", "intent": "calendar_filter"}
{"question": "Close price and dividend cash events for PNW between 2024-02-23 and 2024-03-13.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='PNW' and p.date between '2024-02-23' and '2024-03-13' order by p.date;", "intent": "join_dividends"}
{"question": "Year-to-date cumulative return for MCD.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MCD' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Tickers in sector Real Estate that traded on 2024-09-04.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-09-04' and t.sector='Real Estate' order by 1;", "intent": "membership"}
{"question": "Was NYSE open on 2025-04-01?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-04-01';", "intent": "calendar_filter"}
{"question": "Average close for EQR from 2024-06-05 to 2024-06-13.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EQR' and date between '2024-06-05' and '2024-06-13';", "intent": "avg_between_dates"}
{"question": "Company profile for CLX including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CLX';", "intent": "profile"}
{"question": "Weekly OHLCV for TFX in week 2025-03-24 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TFX' and week='2025-03-24 00:00:00';", "intent": "resample_weekly"}
{"question": "Corporate actions for CAG ordered by date.", "sql": "select * from views.corporate_actions where ticker='CAG' order by event_date;", "intent": "corporate_actions"}
{"question": "Was NYSE open on 2025-08-13?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-08-13';", "intent": "calendar_filter"}
{"question": "Was NYSE open on 2024-07-30?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-07-30';", "intent": "calendar_filter"}
{"question": "Dividend yield TTM time series for CEG.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='CEG' order by date;", "intent": "dividend_yield"}
{"question": "Weekly OHLCV for CCL in week 2025-03-03 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CCL' and week='2025-03-03 00:00:00';", "intent": "resample_weekly"}
{"question": "Split-adjusted close series for D.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='D' order by date;", "intent": "adjusted_price"}
{"question": "Company profile for DVA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='DVA';", "intent": "profile"}
{"question": "Monthly OHLCV for F in 2023-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='F' and month='2023-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for HPQ between 2024-11-26 and 2025-02-28.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='HPQ' and p.date between '2024-11-26' and '2025-02-28' order by p.date;", "intent": "join_dividends"}
{"question": "Show OHLCV for GNRC on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='GNRC') select p.* from core.prices_daily p, d where p.ticker='GNRC' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Split-adjusted close series for VTRS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='VTRS' order by date;", "intent": "adjusted_price"}
{"question": "Tickers in sector Industrials that traded on 2024-11-12.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-11-12' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for DAL between 2023-12-19 and 2024-01-10.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DAL' and p.date between '2023-12-19' and '2024-01-10' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Utilities that traded on 2025-05-20.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-05-20' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for J in week 2024-12-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='J' and week='2024-12-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and split factors for EMN between 2024-12-24 and 2025-01-21.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='EMN' and p.date between '2024-12-24' and '2025-01-21' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-06-20.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-06-20';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Utilities that traded on 2024-09-17.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-09-17' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for OKE between 2024-08-09 and 2024-09-05.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='OKE' and p.date between '2024-08-09' and '2024-09-05' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for MDLZ in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MDLZ' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for OKE between 2024-02-12 and 2024-02-22.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='OKE' and p.date between '2024-02-12' and '2024-02-22' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for HCA in 2025-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='HCA' and month='2025-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for ERIE between 2024-09-13 and 2024-10-18.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ERIE' and p.date between '2024-09-13' and '2024-10-18' order by p.date;", "intent": "join_splits"}
{"question": "Average close for BG from 2024-05-01 to 2024-06-07.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='BG' and date between '2024-05-01' and '2024-06-07';", "intent": "avg_between_dates"}
{"question": "Top 10 gainers by daily return on 2024-10-21.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-10-21' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Show OHLCV for IPG on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='IPG') select p.* from core.prices_daily p, d where p.ticker='IPG' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and split factors for KHC between 2024-06-06 and 2024-07-24.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KHC' and p.date between '2024-06-06' and '2024-07-24' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Financial Services on 2024-01-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-01-12';", "intent": "sector_aggregate"}
{"question": "Top 10 gainers by daily return on 2025-07-14.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-07-14' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Financial Services on 2024-09-13.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-09-13';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for PM between 2025-01-24 and 2025-03-06.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='PM' and p.date between '2025-01-24' and '2025-03-06' order by p.date;", "intent": "join_dividends"}
{"question": "Corporate actions for WST ordered by date.", "sql": "select * from views.corporate_actions where ticker='WST' order by event_date;", "intent": "corporate_actions"}
{"question": "Top 10 gainers by daily return on 2023-11-02.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2023-11-02' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for CFG in week 2024-10-14 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CFG' and week='2024-10-14 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for AIZ including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='AIZ';", "intent": "profile"}
{"question": "Average close and total volume for sector Communication Services on 2024-10-18.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-10-18';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for MDLZ between 2023-11-06 and 2023-12-22.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MDLZ' and p.date between '2023-11-06' and '2023-12-22' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for BDX in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='BDX' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Show OHLCV for FSLR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='FSLR') select p.* from core.prices_daily p, d where p.ticker='FSLR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close for DHI from 2023-12-04 to 2023-12-15.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DHI' and date between '2023-12-04' and '2023-12-15';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for VTR in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='VTR' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for ELV.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ELV' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for WST between 2024-07-11 and 2024-08-14.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='WST' and p.date between '2024-07-11' and '2024-08-14' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for AEE from 2023-10-23 to 2024-01-04.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='AEE' and date between '2023-10-23' and '2024-01-04';", "intent": "avg_between_dates"}
{"question": "Close price and split factors for SO between 2025-06-27 and 2025-07-11.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='SO' and p.date between '2025-06-27' and '2025-07-11' order by p.date;", "intent": "join_splits"}
{"question": "Average close for MRK from 2024-08-02 to 2024-09-04.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='MRK' and date between '2024-08-02' and '2024-09-04';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for FI between 2025-02-18 and 2025-03-11.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='FI' and p.date between '2025-02-18' and '2025-03-11' order by p.date;", "intent": "join_dividends"}
{"question": "Top 10 gainers by daily return on 2025-01-27.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-01-27' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Monthly OHLCV for COR in 2025-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='COR' and month='2025-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "7-day and 30-day returns for SMCI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='SMCI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Monthly OHLCV for NRG in 2025-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NRG' and month='2025-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Top 10 gainers by daily return on 2024-08-30.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-08-30' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for GDDY in week 2024-07-01 00:00:00.", "sql": "select * from views.prices_weekly where ticker='GDDY' and week='2024-07-01 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for EMN including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='EMN';", "intent": "profile"}
{"question": "Average close and total volume for sector Technology on 2024-08-30.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-08-30';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for COST between 2023-11-06 and 2023-11-16.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='COST' and p.date between '2023-11-06' and '2023-11-16' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for KKR between 2024-09-12 and 2024-10-09.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='KKR' and p.date between '2024-09-12' and '2024-10-09' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for DAL from 2024-05-28 to 2024-09-04.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DAL' and date between '2024-05-28' and '2024-09-04';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for CBOE.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='CBOE' order by date;", "intent": "dividend_yield"}
{"question": "7-day and 30-day returns for T.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='T' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "7-day and 30-day returns for NSC.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='NSC' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Latest close and volume for PM.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='PM') select date, close, volume from core.prices_daily, mx where ticker='PM' and date=mx.md;", "intent": "latest_point"}
{"question": "7-day and 30-day returns for HON.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='HON' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Weekly OHLCV for HST in week 2023-11-13 00:00:00.", "sql": "select * from views.prices_weekly where ticker='HST' and week='2023-11-13 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for PLTR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='PLTR') select p.* from core.prices_daily p, d where p.ticker='PLTR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close for COP from 2024-10-14 to 2024-12-09.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='COP' and date between '2024-10-14' and '2024-12-09';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for EMR in week 2024-06-03 00:00:00.", "sql": "select * from views.prices_weekly where ticker='EMR' and week='2024-06-03 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for SYY including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='SYY';", "intent": "profile"}
{"question": "Dividend yield TTM time series for PEP.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PEP' order by date;", "intent": "dividend_yield"}
{"question": "Corporate actions for PLD ordered by date.", "sql": "select * from views.corporate_actions where ticker='PLD' order by event_date;", "intent": "corporate_actions"}
{"question": "Tickers in sector Financial Services that traded on 2024-11-11.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-11-11' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Average close for REG from 2025-01-28 to 2025-04-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='REG' and date between '2025-01-28' and '2025-04-11';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for GWW between 2024-03-11 and 2024-04-22.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GWW' and p.date between '2024-03-11' and '2024-04-22' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for PHM between 2025-06-30 and 2025-08-07.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='PHM' and p.date between '2025-06-30' and '2025-08-07' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for AVB between 2025-01-02 and 2025-01-27.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='AVB' and p.date between '2025-01-02' and '2025-01-27' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for AJG.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AJG') select date, close, volume from core.prices_daily, mx where ticker='AJG' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for EOG between 2024-08-14 and 2024-10-11.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='EOG' and p.date between '2024-08-14' and '2024-10-11' order by p.date;", "intent": "join_dividends"}
{"question": "Dividend yield TTM time series for ALGN.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='ALGN' order by date;", "intent": "dividend_yield"}
{"question": "Tickers in sector Technology that traded on 2024-09-24.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-09-24' and t.sector='Technology' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for ICE in week 2024-08-26 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ICE' and week='2024-08-26 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for IVZ between 2024-07-24 and 2024-10-02.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IVZ' and p.date between '2024-07-24' and '2024-10-02' order by p.date;", "intent": "join_dividends"}
{"question": "Corporate actions for PODD ordered by date.", "sql": "select * from views.corporate_actions where ticker='PODD' order by event_date;", "intent": "corporate_actions"}
{"question": "7-day and 30-day returns for HST.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='HST' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and dividend cash events for MLM between 2025-05-06 and 2025-05-15.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MLM' and p.date between '2025-05-06' and '2025-05-15' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for ABT between 2024-04-05 and 2024-05-06.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ABT' and p.date between '2024-04-05' and '2024-05-06' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for KDP between 2024-03-06 and 2024-03-27.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KDP' and p.date between '2024-03-06' and '2024-03-27' order by p.date;", "intent": "join_splits"}
{"question": "Corporate actions for BRO ordered by date.", "sql": "select * from views.corporate_actions where ticker='BRO' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and split factors for UHS between 2023-11-13 and 2023-12-27.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='UHS' and p.date between '2023-11-13' and '2023-12-27' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for GDDY between 2025-02-05 and 2025-04-02.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='GDDY' and p.date between '2025-02-05' and '2025-04-02' order by p.date;", "intent": "join_splits"}
{"question": "Split-adjusted close series for MAA.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MAA' order by date;", "intent": "adjusted_price"}
{"question": "Close price and split factors for TSN between 2024-08-27 and 2024-10-08.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='TSN' and p.date between '2024-08-27' and '2024-10-08' order by p.date;", "intent": "join_splits"}
{"question": "Top 10 gainers by daily return on 2024-06-11.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-06-11' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Show OHLCV for ICE on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='ICE') select p.* from core.prices_daily p, d where p.ticker='ICE' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for IRM in 2023-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='IRM' and month='2023-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Industrials that traded on 2024-12-16.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-12-16' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Average close for KDP from 2024-07-25 to 2024-08-20.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='KDP' and date between '2024-07-25' and '2024-08-20';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2023-11-22?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-11-22';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for EVRG in 2024-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EVRG' and month='2024-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Was NYSE open on 2023-12-01?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-12-01';", "intent": "calendar_filter"}
{"question": "Close price and split factors for RMD between 2024-11-14 and 2024-12-24.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='RMD' and p.date between '2024-11-14' and '2024-12-24' order by p.date;", "intent": "join_splits"}
{"question": "Average close for DLR from 2024-02-27 to 2024-03-07.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DLR' and date between '2024-02-27' and '2024-03-07';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Communication Services that traded on 2025-08-26.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-08-26' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for TYL in 2025-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TYL' and month='2025-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for LDOS between 2025-02-18 and 2025-03-20.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='LDOS' and p.date between '2025-02-18' and '2025-03-20' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Consumer Defensive that traded on 2025-06-12.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-06-12' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Year-to-date cumulative return for PLTR.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='PLTR' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close for ORCL from 2023-12-15 to 2024-02-12.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ORCL' and date between '2023-12-15' and '2024-02-12';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2024-05-17?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-05-17';", "intent": "calendar_filter"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2025-06-06.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-06-06' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-01-29.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-01-29';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for L in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='L' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for RL between 2025-07-18 and 2025-07-28.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='RL' and p.date between '2025-07-18' and '2025-07-28' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for REGN in week 2025-02-10 00:00:00.", "sql": "select * from views.prices_weekly where ticker='REGN' and week='2025-02-10 00:00:00';", "intent": "resample_weekly"}
{"question": "7-day and 30-day returns for QRVO.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='QRVO' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Was NYSE open on 2025-06-13?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-06-13';", "intent": "calendar_filter"}
{"question": "Split-adjusted close series for TXT.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TXT' order by date;", "intent": "adjusted_price"}
{"question": "Was NYSE open on 2023-11-17?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-11-17';", "intent": "calendar_filter"}
{"question": "Weekly OHLCV for AMT in week 2025-03-17 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AMT' and week='2025-03-17 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for WM in 2023-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='WM' and month='2023-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for IRM between 2025-04-07 and 2025-06-04.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IRM' and p.date between '2025-04-07' and '2025-06-04' order by p.date;", "intent": "join_dividends"}
{"question": "Dividend yield TTM time series for ED.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='ED' order by date;", "intent": "dividend_yield"}
{"question": "Close price and dividend cash events for MHK between 2024-05-28 and 2024-07-19.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MHK' and p.date between '2024-05-28' and '2024-07-19' order by p.date;", "intent": "join_dividends"}
{"question": "Top 10 gainers by daily return on 2025-03-11.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-03-11' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for SWKS in week 2024-07-08 00:00:00.", "sql": "select * from views.prices_weekly where ticker='SWKS' and week='2024-07-08 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for MCD on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='MCD') select p.* from core.prices_daily p, d where p.ticker='MCD' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for DD in 2025-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DD' and month='2025-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for KMI.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='KMI' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for LYB in week 2024-03-04 00:00:00.", "sql": "select * from views.prices_weekly where ticker='LYB' and week='2024-03-04 00:00:00';", "intent": "resample_weekly"}
{"question": "Was NYSE open on 2023-12-29?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2023-12-29';", "intent": "calendar_filter"}
{"question": "Average close and total volume for sector Real Estate on 2023-11-27.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2023-11-27';", "intent": "sector_aggregate"}
{"question": "Split-adjusted close series for OMC.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='OMC' order by date;", "intent": "adjusted_price"}
{"question": "Monthly OHLCV for CPB in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CPB' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for HD including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='HD';", "intent": "profile"}
{"question": "Was NYSE open on 2024-07-11?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-07-11';", "intent": "calendar_filter"}
{"question": "Close price and split factors for OXY between 2025-01-03 and 2025-04-03.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='OXY' and p.date between '2025-01-03' and '2025-04-03' order by p.date;", "intent": "join_splits"}
{"question": "Top 10 gainers by daily return on 2024-10-08.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-10-08' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Healthcare on 2023-11-24.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2023-11-24';", "intent": "sector_aggregate"}
{"question": "Average close for VST from 2024-12-27 to 2025-01-27.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='VST' and date between '2024-12-27' and '2025-01-27';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for IEX in week 2025-02-24 00:00:00.", "sql": "select * from views.prices_weekly where ticker='IEX' and week='2025-02-24 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for ECL from 2024-03-08 to 2024-04-30.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ECL' and date between '2024-03-08' and '2024-04-30';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-05-02.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-05-02' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for HLT between 2024-06-10 and 2024-07-23.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='HLT' and p.date between '2024-06-10' and '2024-07-23' order by p.date;", "intent": "join_splits"}
{"question": "Average close for NTAP from 2024-06-20 to 2024-07-16.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='NTAP' and date between '2024-06-20' and '2024-07-16';", "intent": "avg_between_dates"}
{"question": "Year-to-date cumulative return for BBY.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='BBY' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Company profile for RMD including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='RMD';", "intent": "profile"}
{"question": "Average close and total volume for sector Financial Services on 2025-09-12.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2025-09-12';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Communication Services that traded on 2024-07-16.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-16' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for CZR between 2024-04-17 and 2024-05-23.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CZR' and p.date between '2024-04-17' and '2024-05-23' order by p.date;", "intent": "join_dividends"}
{"question": "Company profile for EQT including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='EQT';", "intent": "profile"}
{"question": "Tickers in sector Energy that traded on 2023-11-02.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-11-02' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "7-day and 30-day returns for JPM.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='JPM' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Year-to-date cumulative return for QCOM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='QCOM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Was NYSE open on 2025-01-21?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-01-21';", "intent": "calendar_filter"}
{"question": "7-day and 30-day returns for PWR.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='PWR' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close and total volume for sector Technology on 2025-01-03.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2025-01-03';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Industrials on 2024-04-22.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2024-04-22';", "intent": "sector_aggregate"}
{"question": "Latest close and volume for RSG.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='RSG') select date, close, volume from core.prices_daily, mx where ticker='RSG' and date=mx.md;", "intent": "latest_point"}
{"question": "7-day and 30-day returns for DRI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='DRI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Show OHLCV for DECK on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DECK') select p.* from core.prices_daily p, d where p.ticker='DECK' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Weekly OHLCV for AXON in week 2025-02-03 00:00:00.", "sql": "select * from views.prices_weekly where ticker='AXON' and week='2025-02-03 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for ERIE between 2024-10-04 and 2024-10-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ERIE' and p.date between '2024-10-04' and '2024-10-17' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for FTV from 2024-07-10 to 2024-08-15.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='FTV' and date between '2024-07-10' and '2024-08-15';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for CVS in week 2025-08-18 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CVS' and week='2025-08-18 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for COP in week 2024-10-14 00:00:00.", "sql": "select * from views.prices_weekly where ticker='COP' and week='2024-10-14 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for O in 2024-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='O' and month='2024-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-04-04.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-04-04' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for FRT in week 2025-05-26 00:00:00.", "sql": "select * from views.prices_weekly where ticker='FRT' and week='2025-05-26 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for NOC in week 2025-10-06 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NOC' and week='2025-10-06 00:00:00';", "intent": "resample_weekly"}
{"question": "Was NYSE open on 2024-05-09?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-05-09';", "intent": "calendar_filter"}
{"question": "Was NYSE open on 2024-09-04?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-09-04';", "intent": "calendar_filter"}
{"question": "Show OHLCV for CFG on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='CFG') select p.* from core.prices_daily p, d where p.ticker='CFG' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-04-08.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-04-08';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for CARR between 2025-05-08 and 2025-05-20.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CARR' and p.date between '2025-05-08' and '2025-05-20' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for BAX in week 2024-06-03 00:00:00.", "sql": "select * from views.prices_weekly where ticker='BAX' and week='2024-06-03 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for MSFT between 2025-08-26 and 2025-10-13.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MSFT' and p.date between '2025-08-26' and '2025-10-13' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2025-03-06.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-03-06' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Consumer Defensive on 2025-06-16.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2025-06-16';", "intent": "sector_aggregate"}
{"question": "Split-adjusted close series for TTWO.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TTWO' order by date;", "intent": "adjusted_price"}
{"question": "Monthly OHLCV for OKE in 2024-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='OKE' and month='2024-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Show OHLCV for STT on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='STT') select p.* from core.prices_daily p, d where p.ticker='STT' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Weekly OHLCV for MCO in week 2024-11-18 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MCO' and week='2024-11-18 00:00:00';", "intent": "resample_weekly"}
{"question": "Corporate actions for CL ordered by date.", "sql": "select * from views.corporate_actions where ticker='CL' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and split factors for FDX between 2024-05-03 and 2024-05-24.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='FDX' and p.date between '2024-05-03' and '2024-05-24' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for MA between 2024-09-27 and 2024-10-10.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MA' and p.date between '2024-09-27' and '2024-10-10' order by p.date;", "intent": "join_dividends"}
{"question": "Split-adjusted close series for TGT.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='TGT' order by date;", "intent": "adjusted_price"}
{"question": "Year-to-date cumulative return for DPZ.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='DPZ' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for STT in week 2024-01-22 00:00:00.", "sql": "select * from views.prices_weekly where ticker='STT' and week='2024-01-22 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for AES in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='AES' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for VICI in 2024-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='VICI' and month='2024-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for EBAY.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='EBAY') select date, close, volume from core.prices_daily, mx where ticker='EBAY' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for PWR from 2025-02-07 to 2025-02-14.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PWR' and date between '2025-02-07' and '2025-02-14';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for DLTR in week 2025-05-05 00:00:00.", "sql": "select * from views.prices_weekly where ticker='DLTR' and week='2025-05-05 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for MHK between 2024-03-04 and 2024-04-08.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MHK' and p.date between '2024-03-04' and '2024-04-08' order by p.date;", "intent": "join_dividends"}
{"question": "Top 10 gainers by daily return on 2024-11-06.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-11-06' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for DVA between 2023-12-27 and 2024-04-12.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='DVA' and p.date between '2023-12-27' and '2024-04-12' order by p.date;", "intent": "join_dividends"}
{"question": "Company profile for APD including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='APD';", "intent": "profile"}
{"question": "Average close and total volume for sector Technology on 2025-08-15.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2025-08-15';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-04-25.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-04-25' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for NCLH between 2025-07-22 and 2025-08-15.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='NCLH' and p.date between '2025-07-22' and '2025-08-15' order by p.date;", "intent": "join_splits"}
{"question": "Dividend yield TTM time series for XYL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='XYL' order by date;", "intent": "dividend_yield"}
{"question": "Latest close and volume for IPG.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='IPG') select date, close, volume from core.prices_daily, mx where ticker='IPG' and date=mx.md;", "intent": "latest_point"}
{"question": "Corporate actions for PM ordered by date.", "sql": "select * from views.corporate_actions where ticker='PM' order by event_date;", "intent": "corporate_actions"}
{"question": "Latest close and volume for KR.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='KR') select date, close, volume from core.prices_daily, mx where ticker='KR' and date=mx.md;", "intent": "latest_point"}
{"question": "Company profile for PFG including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='PFG';", "intent": "profile"}
{"question": "Tickers in sector Consumer Defensive that traded on 2025-02-13.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-02-13' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for ESS in 2025-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ESS' and month='2025-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for ROL between 2024-08-20 and 2024-08-30.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ROL' and p.date between '2024-08-20' and '2024-08-30' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for ALB between 2025-04-30 and 2025-06-04.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ALB' and p.date between '2025-04-30' and '2025-06-04' order by p.date;", "intent": "join_splits"}
{"question": "Top 10 gainers by daily return on 2023-11-22.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2023-11-22' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Corporate actions for EQR ordered by date.", "sql": "select * from views.corporate_actions where ticker='EQR' order by event_date;", "intent": "corporate_actions"}
{"question": "Show OHLCV for EMR on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='EMR') select p.* from core.prices_daily p, d where p.ticker='EMR' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Year-to-date cumulative return for SYK.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='SYK' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Top 10 gainers by daily return on 2024-07-10.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-07-10' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Top 10 gainers by daily return on 2024-01-02.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-01-02' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Dividend yield TTM time series for NWSA.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='NWSA' order by date;", "intent": "dividend_yield"}
{"question": "Latest close and volume for BR.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='BR') select date, close, volume from core.prices_daily, mx where ticker='BR' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for HAS from 2025-07-31 to 2025-09-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HAS' and date between '2025-07-31' and '2025-09-17';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for BLK in week 2024-08-26 00:00:00.", "sql": "select * from views.prices_weekly where ticker='BLK' and week='2024-08-26 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Consumer Defensive that traded on 2023-12-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-12-22' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Utilities that traded on 2024-10-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-10-22' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2024-07-29.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-07-29' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and split factors for BX between 2024-05-06 and 2024-06-11.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='BX' and p.date between '2024-05-06' and '2024-06-11' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for CMCSA in week 2024-02-26 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CMCSA' and week='2024-02-26 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Financial Services on 2024-09-24.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-09-24';", "intent": "sector_aggregate"}
{"question": "7-day and 30-day returns for KO.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='KO' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and split factors for VRSK between 2025-07-02 and 2025-07-21.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='VRSK' and p.date between '2025-07-02' and '2025-07-21' order by p.date;", "intent": "join_splits"}
{"question": "Corporate actions for OXY ordered by date.", "sql": "select * from views.corporate_actions where ticker='OXY' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Communication Services on 2024-12-11.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-12-11';", "intent": "sector_aggregate"}
{"question": "Average close for GM from 2023-12-14 to 2023-12-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GM' and date between '2023-12-14' and '2023-12-26';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Healthcare on 2024-09-25.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-09-25';", "intent": "sector_aggregate"}
{"question": "Split-adjusted close series for GILD.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='GILD' order by date;", "intent": "adjusted_price"}
{"question": "Monthly OHLCV for WY in 2024-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='WY' and month='2024-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Energy that traded on 2024-02-22.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-02-22' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Corporate actions for MTB ordered by date.", "sql": "select * from views.corporate_actions where ticker='MTB' order by event_date;", "intent": "corporate_actions"}
{"question": "Weekly OHLCV for SLB in week 2024-05-13 00:00:00.", "sql": "select * from views.prices_weekly where ticker='SLB' and week='2024-05-13 00:00:00';", "intent": "resample_weekly"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-10-09.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-10-09' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Corporate actions for JNJ ordered by date.", "sql": "select * from views.corporate_actions where ticker='JNJ' order by event_date;", "intent": "corporate_actions"}
{"question": "7-day and 30-day returns for PAYC.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='PAYC' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close for INCY from 2023-12-11 to 2024-03-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='INCY' and date between '2023-12-11' and '2024-03-11';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for GNRC between 2024-04-29 and 2024-05-09.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GNRC' and p.date between '2024-04-29' and '2024-05-09' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for CHD between 2025-06-03 and 2025-07-22.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CHD' and p.date between '2025-06-03' and '2025-07-22' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for LYV in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='LYV' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for REGN ordered by date.", "sql": "select * from views.corporate_actions where ticker='REGN' order by event_date;", "intent": "corporate_actions"}
{"question": "Year-to-date cumulative return for DAY.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='DAY' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and split factors for WELL between 2025-02-05 and 2025-02-24.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='WELL' and p.date between '2025-02-05' and '2025-02-24' order by p.date;", "intent": "join_splits"}
{"question": "Latest close and volume for GPC.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='GPC') select date, close, volume from core.prices_daily, mx where ticker='GPC' and date=mx.md;", "intent": "latest_point"}
{"question": "Monthly OHLCV for HSIC in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='HSIC' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close and total volume for sector Utilities on 2025-07-17.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2025-07-17';", "intent": "sector_aggregate"}
{"question": "Dividend yield TTM time series for LRCX.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='LRCX' order by date;", "intent": "dividend_yield"}
{"question": "Average close and total volume for sector Technology on 2024-01-16.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-01-16';", "intent": "sector_aggregate"}
{"question": "Latest close and volume for VRTX.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='VRTX') select date, close, volume from core.prices_daily, mx where ticker='VRTX' and date=mx.md;", "intent": "latest_point"}
{"question": "Company profile for MOH including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='MOH';", "intent": "profile"}
{"question": "Close price and split factors for HST between 2024-03-05 and 2024-04-18.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='HST' and p.date between '2024-03-05' and '2024-04-18' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for FAST in week 2024-07-08 00:00:00.", "sql": "select * from views.prices_weekly where ticker='FAST' and week='2024-07-08 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for OMC on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='OMC') select p.* from core.prices_daily p, d where p.ticker='OMC' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Dividend yield TTM time series for CTVA.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='CTVA' order by date;", "intent": "dividend_yield"}
{"question": "Monthly OHLCV for COP in 2024-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='COP' and month='2024-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for WEC in week 2024-12-09 00:00:00.", "sql": "select * from views.prices_weekly where ticker='WEC' and week='2024-12-09 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for RTX in 2025-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='RTX' and month='2025-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for CL.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CL' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Company profile for LYV including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='LYV';", "intent": "profile"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-07-31.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-31' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for MTCH between 2025-06-27 and 2025-07-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MTCH' and p.date between '2025-06-27' and '2025-07-16' order by p.date;", "intent": "join_splits"}
{"question": "Was NYSE open on 2024-02-21?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-02-21';", "intent": "calendar_filter"}
{"question": "Weekly OHLCV for PPG in week 2025-06-16 00:00:00.", "sql": "select * from views.prices_weekly where ticker='PPG' and week='2025-06-16 00:00:00';", "intent": "resample_weekly"}
{"question": "7-day and 30-day returns for REGN.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='REGN' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and split factors for BDX between 2025-09-04 and 2025-09-29.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='BDX' and p.date between '2025-09-04' and '2025-09-29' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for WM in week 2025-01-06 00:00:00.", "sql": "select * from views.prices_weekly where ticker='WM' and week='2025-01-06 00:00:00';", "intent": "resample_weekly"}
{"question": "Company profile for GEHC including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='GEHC';", "intent": "profile"}
{"question": "Average close and total volume for sector Communication Services on 2023-11-30.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2023-11-30';", "intent": "sector_aggregate"}
{"question": "Average close for F from 2024-10-30 to 2024-12-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='F' and date between '2024-10-30' and '2024-12-11';", "intent": "avg_between_dates"}
{"question": "Average close for EIX from 2024-12-03 to 2024-12-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EIX' and date between '2024-12-03' and '2024-12-17';", "intent": "avg_between_dates"}
{"question": "Year-to-date cumulative return for CF.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CF' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "7-day and 30-day returns for LUV.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='LUV' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and split factors for GOOGL between 2024-09-12 and 2024-10-15.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='GOOGL' and p.date between '2024-09-12' and '2024-10-15' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Communication Services that traded on 2023-12-13.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-12-13' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for AES in 2025-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='AES' and month='2025-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for HCA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='HCA';", "intent": "profile"}
{"question": "Weekly OHLCV for REG in week 2023-11-06 00:00:00.", "sql": "select * from views.prices_weekly where ticker='REG' and week='2023-11-06 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for UNP from 2025-09-08 to 2025-10-07.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='UNP' and date between '2025-09-08' and '2025-10-07';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for FOX in week 2025-02-17 00:00:00.", "sql": "select * from views.prices_weekly where ticker='FOX' and week='2025-02-17 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for POOL.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='POOL' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Split-adjusted close series for MNST.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MNST' order by date;", "intent": "adjusted_price"}
{"question": "7-day and 30-day returns for MNST.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='MNST' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Corporate actions for CPRT ordered by date.", "sql": "select * from views.corporate_actions where ticker='CPRT' order by event_date;", "intent": "corporate_actions"}
{"question": "7-day and 30-day returns for SBAC.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='SBAC' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and split factors for BALL between 2024-08-08 and 2024-09-17.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='BALL' and p.date between '2024-08-08' and '2024-09-17' order by p.date;", "intent": "join_splits"}
{"question": "Split-adjusted close series for JKHY.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='JKHY' order by date;", "intent": "adjusted_price"}
{"question": "Weekly OHLCV for BG in week 2025-04-14 00:00:00.", "sql": "select * from views.prices_weekly where ticker='BG' and week='2025-04-14 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for ENPH in 2025-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ENPH' and month='2025-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Dividend yield TTM time series for VRTX.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='VRTX' order by date;", "intent": "dividend_yield"}
{"question": "Weekly OHLCV for MNST in week 2025-06-09 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MNST' and week='2025-06-09 00:00:00';", "intent": "resample_weekly"}
{"question": "Dividend yield TTM time series for WDC.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='WDC' order by date;", "intent": "dividend_yield"}
{"question": "Year-to-date cumulative return for CVX.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CVX' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Split-adjusted close series for HD.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='HD' order by date;", "intent": "adjusted_price"}
{"question": "Weekly OHLCV for MOH in week 2025-03-31 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MOH' and week='2025-03-31 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for CAG in week 2024-09-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CAG' and week='2024-09-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Split-adjusted close series for COST.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='COST' order by date;", "intent": "adjusted_price"}
{"question": "Year-to-date cumulative return for AVY.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='AVY' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for PH between 2023-11-16 and 2023-11-27.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='PH' and p.date between '2023-11-16' and '2023-11-27' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for KR between 2025-05-14 and 2025-05-28.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='KR' and p.date between '2025-05-14' and '2025-05-28' order by p.date;", "intent": "join_dividends"}
{"question": "Year-to-date cumulative return for WAB.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='WAB' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Monthly OHLCV for FTNT in 2025-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='FTNT' and month='2025-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for PFE between 2023-11-24 and 2024-02-01.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='PFE' and p.date between '2023-11-24' and '2024-02-01' order by p.date;", "intent": "join_dividends"}
{"question": "7-day and 30-day returns for MKTX.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='MKTX' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Show OHLCV for DPZ on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='DPZ') select p.* from core.prices_daily p, d where p.ticker='DPZ' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Was NYSE open on 2025-02-10?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-02-10';", "intent": "calendar_filter"}
{"question": "Corporate actions for APH ordered by date.", "sql": "select * from views.corporate_actions where ticker='APH' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Financial Services on 2024-02-29.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-02-29';", "intent": "sector_aggregate"}
{"question": "7-day and 30-day returns for DHI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='DHI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Split-adjusted close series for DXCM.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='DXCM' order by date;", "intent": "adjusted_price"}
{"question": "Was NYSE open on 2024-12-06?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-12-06';", "intent": "calendar_filter"}
{"question": "Average close for AEP from 2024-08-20 to 2024-10-18.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='AEP' and date between '2024-08-20' and '2024-10-18';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for CPRT in week 2023-11-20 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CPRT' and week='2023-11-20 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for PKG in 2025-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PKG' and month='2025-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for F between 2024-08-14 and 2024-11-15.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='F' and p.date between '2024-08-14' and '2024-11-15' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for EBAY in week 2024-12-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='EBAY' and week='2024-12-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Healthcare on 2024-03-08.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-03-08';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for CRM in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CRM' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for NOW.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='NOW') select date, close, volume from core.prices_daily, mx where ticker='NOW' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for POOL in week 2025-03-31 00:00:00.", "sql": "select * from views.prices_weekly where ticker='POOL' and week='2025-03-31 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close for AMD from 2025-05-16 to 2025-06-24.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='AMD' and date between '2025-05-16' and '2025-06-24';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2024-02-07?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-02-07';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for TROW in 2024-07-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TROW' and month='2024-07-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for DD.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='DD' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Show OHLCV for UNP on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='UNP') select p.* from core.prices_daily p, d where p.ticker='UNP' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for CRM in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CRM' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Utilities that traded on 2024-08-15.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-15' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Was NYSE open on 2025-08-19?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-08-19';", "intent": "calendar_filter"}
{"question": "Monthly OHLCV for BDX in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='BDX' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Top 10 gainers by daily return on 2024-11-07.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-11-07' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Tickers in sector Financial Services that traded on 2025-07-31.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-07-31' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for AES.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AES') select date, close, volume from core.prices_daily, mx where ticker='AES' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for LVS between 2024-09-19 and 2024-10-10.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LVS' and p.date between '2024-09-19' and '2024-10-10' order by p.date;", "intent": "join_dividends"}
{"question": "7-day and 30-day returns for CZR.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='CZR' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Corporate actions for LNT ordered by date.", "sql": "select * from views.corporate_actions where ticker='LNT' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close for KEY from 2024-11-14 to 2025-01-03.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='KEY' and date between '2024-11-14' and '2025-01-03';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2025-06-30?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2025-06-30';", "intent": "calendar_filter"}
{"question": "Year-to-date cumulative return for DGX.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='DGX' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for HOLX between 2025-08-25 and 2025-09-18.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='HOLX' and p.date between '2025-08-25' and '2025-09-18' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for EXPD in 2025-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EXPD' and month='2025-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for BA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='BA';", "intent": "profile"}
{"question": "Close price and split factors for IQV between 2024-10-21 and 2024-11-04.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='IQV' and p.date between '2024-10-21' and '2024-11-04' order by p.date;", "intent": "join_splits"}
{"question": "Year-to-date cumulative return for STLD.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='STLD' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Year-to-date cumulative return for AMT.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='AMT' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-07-09.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-09' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for ICE between 2023-12-27 and 2024-01-26.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ICE' and p.date between '2023-12-27' and '2024-01-26' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Energy that traded on 2024-09-03.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-09-03' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Average close for GEHC from 2024-05-30 to 2024-06-14.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GEHC' and date between '2024-05-30' and '2024-06-14';", "intent": "avg_between_dates"}
{"question": "Top 10 gainers by daily return on 2024-01-19.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-01-19' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Industrials on 2024-05-09.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2024-05-09';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Energy that traded on 2025-01-15.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-01-15' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Split-adjusted close series for MRNA.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='MRNA' order by date;", "intent": "adjusted_price"}
{"question": "Top 10 gainers by daily return on 2023-11-16.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2023-11-16' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Tickers in sector Energy that traded on 2025-06-18.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-06-18' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for MCD between 2024-11-29 and 2025-01-10.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MCD' and p.date between '2024-11-29' and '2025-01-10' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for KMX between 2023-11-20 and 2024-03-11.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='KMX' and p.date between '2023-11-20' and '2024-03-11' order by p.date;", "intent": "join_dividends"}
{"question": "7-day and 30-day returns for NWS.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='NWS' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Top 10 gainers by daily return on 2024-10-24.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-10-24' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Top 10 gainers by daily return on 2025-04-16.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-04-16' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Show OHLCV for JBL on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='JBL') select p.* from core.prices_daily p, d where p.ticker='JBL' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "7-day and 30-day returns for TYL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='TYL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close for GEV from 2025-02-07 to 2025-02-18.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GEV' and date between '2025-02-07' and '2025-02-18';", "intent": "avg_between_dates"}
{"question": "Top 10 gainers by daily return on 2024-03-18.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-03-18' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for HUBB between 2025-06-23 and 2025-08-01.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='HUBB' and p.date between '2025-06-23' and '2025-08-01' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for TGT between 2024-02-28 and 2024-03-11.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='TGT' and p.date between '2024-02-28' and '2024-03-11' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for LOW from 2025-04-11 to 2025-06-24.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='LOW' and date between '2025-04-11' and '2025-06-24';", "intent": "avg_between_dates"}
{"question": "Show OHLCV for SYK on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='SYK') select p.* from core.prices_daily p, d where p.ticker='SYK' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Top 10 gainers by daily return on 2025-04-04.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-04-04' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Corporate actions for MTD ordered by date.", "sql": "select * from views.corporate_actions where ticker='MTD' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Financial Services on 2024-07-01.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-07-01';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for T between 2024-07-10 and 2024-08-19.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='T' and p.date between '2024-07-10' and '2024-08-19' order by p.date;", "intent": "join_splits"}
{"question": "Latest close and volume for HIG.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='HIG') select date, close, volume from core.prices_daily, mx where ticker='HIG' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for MCO in week 2024-04-08 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MCO' and week='2024-04-08 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and split factors for DELL between 2025-08-19 and 2025-10-07.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DELL' and p.date between '2025-08-19' and '2025-10-07' order by p.date;", "intent": "join_splits"}
{"question": "Dividend yield TTM time series for EMR.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='EMR' order by date;", "intent": "dividend_yield"}
{"question": "Was NYSE open on 2024-09-25?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-09-25';", "intent": "calendar_filter"}
{"question": "Close price and dividend cash events for MCHP between 2025-05-05 and 2025-05-20.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MCHP' and p.date between '2025-05-05' and '2025-05-20' order by p.date;", "intent": "join_dividends"}
{"question": "Top 10 gainers by daily return on 2025-02-26.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-02-26' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Split-adjusted close series for OTIS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='OTIS' order by date;", "intent": "adjusted_price"}
{"question": "Dividend yield TTM time series for DAL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='DAL' order by date;", "intent": "dividend_yield"}
{"question": "Year-to-date cumulative return for O.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='O' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for APA between 2024-03-13 and 2024-04-12.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='APA' and p.date between '2024-03-13' and '2024-04-12' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for FMC from 2024-04-18 to 2024-05-13.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='FMC' and date between '2024-04-18' and '2024-05-13';", "intent": "avg_between_dates"}
{"question": "Average close for CMG from 2024-11-25 to 2024-12-12.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CMG' and date between '2024-11-25' and '2024-12-12';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for ED between 2025-02-14 and 2025-03-31.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ED' and p.date between '2025-02-14' and '2025-03-31' order by p.date;", "intent": "join_dividends"}
{"question": "Was NYSE open on 2024-05-02?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-05-02';", "intent": "calendar_filter"}
{"question": "Tickers in sector Basic Materials that traded on 2023-12-20.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2023-12-20' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Was NYSE open on 2024-04-04?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-04-04';", "intent": "calendar_filter"}
{"question": "Close price and split factors for EQT between 2024-06-05 and 2024-06-17.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='EQT' and p.date between '2024-06-05' and '2024-06-17' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Consumer Defensive on 2024-07-11.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2024-07-11';", "intent": "sector_aggregate"}
{"question": "Average close for PLTR from 2024-02-27 to 2024-03-05.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PLTR' and date between '2024-02-27' and '2024-03-05';", "intent": "avg_between_dates"}
{"question": "7-day and 30-day returns for ORCL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='ORCL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Close price and split factors for CI between 2023-12-07 and 2024-03-15.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CI' and p.date between '2023-12-07' and '2024-03-15' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for OKE between 2025-08-11 and 2025-09-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='OKE' and p.date between '2025-08-11' and '2025-09-17' order by p.date;", "intent": "join_dividends"}
{"question": "Company profile for EPAM including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='EPAM';", "intent": "profile"}
{"question": "Was NYSE open on 2024-08-02?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-08-02';", "intent": "calendar_filter"}
{"question": "Was NYSE open on 2024-10-10?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-10-10';", "intent": "calendar_filter"}
{"question": "7-day and 30-day returns for INVH.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='INVH' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close for WY from 2025-01-10 to 2025-02-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='WY' and date between '2025-01-10' and '2025-02-21';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Basic Materials on 2024-10-08.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2024-10-08';", "intent": "sector_aggregate"}
{"question": "Latest close and volume for NEE.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='NEE') select date, close, volume from core.prices_daily, mx where ticker='NEE' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for MOS from 2025-09-10 to 2025-10-14.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='MOS' and date between '2025-09-10' and '2025-10-14';", "intent": "avg_between_dates"}
{"question": "Split-adjusted close series for VLTO.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='VLTO' order by date;", "intent": "adjusted_price"}
{"question": "7-day and 30-day returns for ECL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='ECL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Company profile for CMCSA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CMCSA';", "intent": "profile"}
{"question": "Close price and dividend cash events for IBM between 2025-04-16 and 2025-06-20.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IBM' and p.date between '2025-04-16' and '2025-06-20' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for O.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='O') select date, close, volume from core.prices_daily, mx where ticker='O' and date=mx.md;", "intent": "latest_point"}
{"question": "Company profile for ELV including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='ELV';", "intent": "profile"}
{"question": "Tickers in sector Energy that traded on 2024-10-04.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-10-04' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Average close for PH from 2025-06-05 to 2025-06-30.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='PH' and date between '2025-06-05' and '2025-06-30';", "intent": "avg_between_dates"}
{"question": "Corporate actions for TXN ordered by date.", "sql": "select * from views.corporate_actions where ticker='TXN' order by event_date;", "intent": "corporate_actions"}
{"question": "Monthly OHLCV for AWK in 2023-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='AWK' and month='2023-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for HD in week 2024-01-29 00:00:00.", "sql": "select * from views.prices_weekly where ticker='HD' and week='2024-01-29 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for MSCI.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MSCI' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and split factors for FFIV between 2024-08-27 and 2024-10-08.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='FFIV' and p.date between '2024-08-27' and '2024-10-08' order by p.date;", "intent": "join_splits"}
{"question": "Corporate actions for KMI ordered by date.", "sql": "select * from views.corporate_actions where ticker='KMI' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and dividend cash events for MOH between 2024-10-07 and 2024-10-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MOH' and p.date between '2024-10-07' and '2024-10-17' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Consumer Defensive that traded on 2024-03-18.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-18' and t.sector='Consumer Defensive' order by 1;", "intent": "membership"}
{"question": "Show OHLCV for ECL on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='ECL') select p.* from core.prices_daily p, d where p.ticker='ECL' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close and total volume for sector Healthcare on 2024-08-02.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-08-02';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for PFG in 2024-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PFG' and month='2024-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-01-08.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-01-08' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Top 10 gainers by daily return on 2024-08-26.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-08-26' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close for VTRS from 2025-08-18 to 2025-09-18.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='VTRS' and date between '2025-08-18' and '2025-09-18';", "intent": "avg_between_dates"}
{"question": "Latest close and volume for EQIX.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='EQIX') select date, close, volume from core.prices_daily, mx where ticker='EQIX' and date=mx.md;", "intent": "latest_point"}
{"question": "7-day and 30-day returns for AME.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='AME' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Show OHLCV for LYB on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='LYB') select p.* from core.prices_daily p, d where p.ticker='LYB' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for PAYC in 2025-04-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PAYC' and month='2025-04-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for J in week 2025-06-02 00:00:00.", "sql": "select * from views.prices_weekly where ticker='J' and week='2025-06-02 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and split factors for GILD between 2024-10-03 and 2024-10-29.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='GILD' and p.date between '2024-10-03' and '2024-10-29' order by p.date;", "intent": "join_splits"}
{"question": "Dividend yield TTM time series for CI.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='CI' order by date;", "intent": "dividend_yield"}
{"question": "Company profile for FOXA including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='FOXA';", "intent": "profile"}
{"question": "Latest close and volume for PTC.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='PTC') select date, close, volume from core.prices_daily, mx where ticker='PTC' and date=mx.md;", "intent": "latest_point"}
{"question": "Dividend yield TTM time series for PGR.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PGR' order by date;", "intent": "dividend_yield"}
{"question": "Weekly OHLCV for A in week 2025-02-03 00:00:00.", "sql": "select * from views.prices_weekly where ticker='A' and week='2025-02-03 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for MU in 2025-05-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MU' and month='2025-05-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for NWS in week 2024-07-01 00:00:00.", "sql": "select * from views.prices_weekly where ticker='NWS' and week='2024-07-01 00:00:00';", "intent": "resample_weekly"}
{"question": "7-day and 30-day returns for ORLY.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='ORLY' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Tickers in sector Energy that traded on 2025-08-15.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-08-15' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for HLT.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='HLT') select date, close, volume from core.prices_daily, mx where ticker='HLT' and date=mx.md;", "intent": "latest_point"}
{"question": "Company profile for CEG including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CEG';", "intent": "profile"}
{"question": "Average close for EXPE from 2024-04-30 to 2024-08-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EXPE' and date between '2024-04-30' and '2024-08-21';", "intent": "avg_between_dates"}
{"question": "Company profile for CAH including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CAH';", "intent": "profile"}
{"question": "Monthly OHLCV for ZBH in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ZBH' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Monthly OHLCV for NEE in 2025-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='NEE' and month='2025-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for PEG between 2025-03-24 and 2025-05-09.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PEG' and p.date between '2025-03-24' and '2025-05-09' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for TROW between 2025-04-25 and 2025-08-12.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='TROW' and p.date between '2025-04-25' and '2025-08-12' order by p.date;", "intent": "join_splits"}
{"question": "Was NYSE open on 2024-04-03?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-04-03';", "intent": "calendar_filter"}
{"question": "Top 10 gainers by daily return on 2024-10-22.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-10-22' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Monthly OHLCV for TPR in 2025-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TPR' and month='2025-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Top 10 gainers by daily return on 2024-03-14.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-03-14' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Dividend yield TTM time series for STT.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='STT' order by date;", "intent": "dividend_yield"}
{"question": "Close price and dividend cash events for GILD between 2023-12-22 and 2024-01-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GILD' and p.date between '2023-12-22' and '2024-01-17' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Energy that traded on 2024-03-26.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-03-26' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for ROP in week 2025-06-30 00:00:00.", "sql": "select * from views.prices_weekly where ticker='ROP' and week='2025-06-30 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for MS in 2024-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MS' and month='2024-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for PYPL.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='PYPL') select date, close, volume from core.prices_daily, mx where ticker='PYPL' and date=mx.md;", "intent": "latest_point"}
{"question": "Monthly OHLCV for DXCM in 2024-03-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='DXCM' and month='2024-03-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for GEN between 2024-02-26 and 2024-05-07.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='GEN' and p.date between '2024-02-26' and '2024-05-07' order by p.date;", "intent": "join_dividends"}
{"question": "7-day and 30-day returns for CHRW.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='CHRW' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Top 10 gainers by daily return on 2024-07-09.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-07-09' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Close price and dividend cash events for TFX between 2024-12-26 and 2025-03-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='TFX' and p.date between '2024-12-26' and '2025-03-17' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for IRM between 2023-10-25 and 2023-11-27.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='IRM' and p.date between '2023-10-25' and '2023-11-27' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for EMN in 2023-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='EMN' and month='2023-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for ADI ordered by date.", "sql": "select * from views.corporate_actions where ticker='ADI' order by event_date;", "intent": "corporate_actions"}
{"question": "7-day and 30-day returns for JNJ.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='JNJ' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Show OHLCV for TECH on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='TECH') select p.* from core.prices_daily p, d where p.ticker='TECH' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "7-day and 30-day returns for UAL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='UAL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Weekly OHLCV for CLX in week 2025-05-19 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CLX' and week='2025-05-19 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2025-03-28.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2025-03-28';", "intent": "sector_aggregate"}
{"question": "Close price and dividend cash events for RF between 2023-11-17 and 2023-12-18.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='RF' and p.date between '2023-11-17' and '2023-12-18' order by p.date;", "intent": "join_dividends"}
{"question": "Split-adjusted close series for FANG.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='FANG' order by date;", "intent": "adjusted_price"}
{"question": "Weekly OHLCV for STT in week 2024-10-28 00:00:00.", "sql": "select * from views.prices_weekly where ticker='STT' and week='2024-10-28 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Utilities on 2024-09-05.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2024-09-05';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Financial Services on 2024-07-08.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-07-08';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Energy on 2024-11-01.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2024-11-01';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for WELL between 2025-05-19 and 2025-07-09.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='WELL' and p.date between '2025-05-19' and '2025-07-09' order by p.date;", "intent": "join_splits"}
{"question": "Latest close and volume for SNA.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='SNA') select date, close, volume from core.prices_daily, mx where ticker='SNA' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and split factors for KHC between 2025-03-25 and 2025-04-17.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KHC' and p.date between '2025-03-25' and '2025-04-17' order by p.date;", "intent": "join_splits"}
{"question": "Weekly OHLCV for MSCI in week 2025-08-04 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MSCI' and week='2025-08-04 00:00:00';", "intent": "resample_weekly"}
{"question": "Average close and total volume for sector Real Estate on 2024-10-31.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2024-10-31';", "intent": "sector_aggregate"}
{"question": "Average close for RMD from 2025-06-05 to 2025-08-13.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='RMD' and date between '2025-06-05' and '2025-08-13';", "intent": "avg_between_dates"}
{"question": "Year-to-date cumulative return for CRM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='CRM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for HWM between 2024-03-26 and 2024-04-29.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='HWM' and p.date between '2024-03-26' and '2024-04-29' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Utilities that traded on 2024-06-25.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-06-25' and t.sector='Utilities' order by 1;", "intent": "membership"}
{"question": "Monthly OHLCV for PPL in 2025-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='PPL' and month='2025-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for IP.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='IP') select date, close, volume from core.prices_daily, mx where ticker='IP' and date=mx.md;", "intent": "latest_point"}
{"question": "Monthly OHLCV for IP in 2024-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='IP' and month='2024-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Average close for APH from 2025-02-11 to 2025-03-17.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='APH' and date between '2025-02-11' and '2025-03-17';", "intent": "avg_between_dates"}
{"question": "Average close for EOG from 2024-09-23 to 2024-10-31.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='EOG' and date between '2024-09-23' and '2024-10-31';", "intent": "avg_between_dates"}
{"question": "Average close for APA from 2024-12-06 to 2025-02-11.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='APA' and date between '2024-12-06' and '2025-02-11';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Basic Materials that traded on 2024-05-14.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-05-14' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "7-day and 30-day returns for URI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='URI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Dividend yield TTM time series for GL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='GL' order by date;", "intent": "dividend_yield"}
{"question": "Split-adjusted close series for DVN.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='DVN' order by date;", "intent": "adjusted_price"}
{"question": "Latest close and volume for AMZN.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='AMZN') select date, close, volume from core.prices_daily, mx where ticker='AMZN' and date=mx.md;", "intent": "latest_point"}
{"question": "Close price and dividend cash events for ESS between 2025-08-25 and 2025-10-01.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='ESS' and p.date between '2025-08-25' and '2025-10-01' order by p.date;", "intent": "join_dividends"}
{"question": "Latest close and volume for ABBV.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='ABBV') select date, close, volume from core.prices_daily, mx where ticker='ABBV' and date=mx.md;", "intent": "latest_point"}
{"question": "Weekly OHLCV for CHTR in week 2024-06-03 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CHTR' and week='2024-06-03 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for CZR between 2024-06-13 and 2024-07-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CZR' and p.date between '2024-06-13' and '2024-07-17' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for ABT between 2024-03-21 and 2024-05-08.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='ABT' and p.date between '2024-03-21' and '2024-05-08' order by p.date;", "intent": "join_splits"}
{"question": "Corporate actions for D ordered by date.", "sql": "select * from views.corporate_actions where ticker='D' order by event_date;", "intent": "corporate_actions"}
{"question": "Dividend yield TTM time series for MKC.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='MKC' order by date;", "intent": "dividend_yield"}
{"question": "Corporate actions for PAYX ordered by date.", "sql": "select * from views.corporate_actions where ticker='PAYX' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Healthcare on 2023-12-28.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2023-12-28';", "intent": "sector_aggregate"}
{"question": "Company profile for GL including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='GL';", "intent": "profile"}
{"question": "Average close and total volume for sector Communication Services on 2025-06-16.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2025-06-16';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for TPR in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TPR' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Weekly OHLCV for RL in week 2025-03-24 00:00:00.", "sql": "select * from views.prices_weekly where ticker='RL' and week='2025-03-24 00:00:00';", "intent": "resample_weekly"}
{"question": "Dividend yield TTM time series for TYL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='TYL' order by date;", "intent": "dividend_yield"}
{"question": "Corporate actions for TRGP ordered by date.", "sql": "select * from views.corporate_actions where ticker='TRGP' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Industrials on 2023-11-20.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2023-11-20';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for MCHP in 2023-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MCHP' and month='2023-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and dividend cash events for CRL between 2024-09-23 and 2024-10-22.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='CRL' and p.date between '2024-09-23' and '2024-10-22' order by p.date;", "intent": "join_dividends"}
{"question": "Dividend yield TTM time series for KIM.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='KIM' order by date;", "intent": "dividend_yield"}
{"question": "7-day and 30-day returns for JBL.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='JBL' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Latest close and volume for TPL.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='TPL') select date, close, volume from core.prices_daily, mx where ticker='TPL' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close for GE from 2024-12-09 to 2024-12-31.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GE' and date between '2024-12-09' and '2024-12-31';", "intent": "avg_between_dates"}
{"question": "Dividend yield TTM time series for DPZ.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='DPZ' order by date;", "intent": "dividend_yield"}
{"question": "Split-adjusted close series for LVS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='LVS' order by date;", "intent": "adjusted_price"}
{"question": "Weekly OHLCV for BRO in week 2025-03-31 00:00:00.", "sql": "select * from views.prices_weekly where ticker='BRO' and week='2025-03-31 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for ODFL on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='ODFL') select p.* from core.prices_daily p, d where p.ticker='ODFL' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Average close and total volume for sector Utilities on 2025-01-03.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Utilities' and p.date='2025-01-03';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for JKHY in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='JKHY' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for SMCI.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='SMCI') select date, close, volume from core.prices_daily, mx where ticker='SMCI' and date=mx.md;", "intent": "latest_point"}
{"question": "Year-to-date cumulative return for RSG.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='RSG' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Close price and dividend cash events for MPWR between 2024-09-16 and 2024-09-25.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='MPWR' and p.date between '2024-09-16' and '2024-09-25' order by p.date;", "intent": "join_dividends"}
{"question": "Average close and total volume for sector Consumer Defensive on 2024-08-01.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Defensive' and p.date='2024-08-01';", "intent": "sector_aggregate"}
{"question": "Monthly OHLCV for WFC in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='WFC' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for RL ordered by date.", "sql": "select * from views.corporate_actions where ticker='RL' order by event_date;", "intent": "corporate_actions"}
{"question": "Dividend yield TTM time series for T.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='T' order by date;", "intent": "dividend_yield"}
{"question": "Top 10 gainers by daily return on 2023-12-21.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2023-12-21' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Top 10 gainers by daily return on 2025-06-10.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2025-06-10' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Year-to-date cumulative return for ROK.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='ROK' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for MPC in week 2024-02-19 00:00:00.", "sql": "select * from views.prices_weekly where ticker='MPC' and week='2024-02-19 00:00:00';", "intent": "resample_weekly"}
{"question": "Split-adjusted close series for ZBH.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='ZBH' order by date;", "intent": "adjusted_price"}
{"question": "Average close and total volume for sector Communication Services on 2024-08-02.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-08-02';", "intent": "sector_aggregate"}
{"question": "Corporate actions for NKE ordered by date.", "sql": "select * from views.corporate_actions where ticker='NKE' order by event_date;", "intent": "corporate_actions"}
{"question": "Latest close and volume for RCL.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='RCL') select date, close, volume from core.prices_daily, mx where ticker='RCL' and date=mx.md;", "intent": "latest_point"}
{"question": "Monthly OHLCV for GL in 2024-11-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='GL' and month='2024-11-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for MCK between 2025-03-14 and 2025-03-31.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='MCK' and p.date between '2025-03-14' and '2025-03-31' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for T between 2024-09-05 and 2024-10-14.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='T' and p.date between '2024-09-05' and '2024-10-14' order by p.date;", "intent": "join_splits"}
{"question": "Close price and dividend cash events for LYB between 2024-09-30 and 2024-10-15.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LYB' and p.date between '2024-09-30' and '2024-10-15' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-06-13.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-06-13' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Average close for HCA from 2025-08-01 to 2025-10-02.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='HCA' and date between '2025-08-01' and '2025-10-02';", "intent": "avg_between_dates"}
{"question": "Close price and dividend cash events for LEN between 2024-07-16 and 2024-07-24.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='LEN' and p.date between '2024-07-16' and '2024-07-24' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for CPT in 2023-12-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CPT' and month='2023-12-01 00:00:00';", "intent": "resample_monthly"}
{"question": "7-day and 30-day returns for HIG.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='HIG' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Monthly OHLCV for GOOGL in 2025-08-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='GOOGL' and month='2025-08-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for NFLX.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='NFLX' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for NWS between 2023-10-26 and 2023-12-20.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='NWS' and p.date between '2023-10-26' and '2023-12-20' order by p.date;", "intent": "join_dividends"}
{"question": "Corporate actions for NSC ordered by date.", "sql": "select * from views.corporate_actions where ticker='NSC' order by event_date;", "intent": "corporate_actions"}
{"question": "Show OHLCV for GPN on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='GPN') select p.* from core.prices_daily p, d where p.ticker='GPN' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Close price and dividend cash events for BIIB between 2025-03-11 and 2025-04-04.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='BIIB' and p.date between '2025-03-11' and '2025-04-04' order by p.date;", "intent": "join_dividends"}
{"question": "Dividend yield TTM time series for PCAR.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='PCAR' order by date;", "intent": "dividend_yield"}
{"question": "Weekly OHLCV for CHTR in week 2024-04-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CHTR' and week='2024-04-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Show OHLCV for INCY on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='INCY') select p.* from core.prices_daily p, d where p.ticker='INCY' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Monthly OHLCV for ADBE in 2025-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ADBE' and month='2025-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for IDXX ordered by date.", "sql": "select * from views.corporate_actions where ticker='IDXX' order by event_date;", "intent": "corporate_actions"}
{"question": "Close price and split factors for GEV between 2025-05-01 and 2025-05-28.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='GEV' and p.date between '2025-05-01' and '2025-05-28' order by p.date;", "intent": "join_splits"}
{"question": "Average close for CMS from 2025-08-26 to 2025-09-03.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='CMS' and date between '2025-08-26' and '2025-09-03';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Communication Services that traded on 2024-11-05.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-11-05' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Company profile for EIX including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='EIX';", "intent": "profile"}
{"question": "Close price and split factors for JNJ between 2024-12-02 and 2025-01-21.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='JNJ' and p.date between '2024-12-02' and '2025-01-21' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Consumer Cyclical that traded on 2024-11-04.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-11-04' and t.sector='Consumer Cyclical' order by 1;", "intent": "membership"}
{"question": "Year-to-date cumulative return for MTD.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='MTD' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Top 10 gainers by daily return on 2024-12-30.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-12-30' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Average close and total volume for sector Communication Services on 2025-03-10.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2025-03-10';", "intent": "sector_aggregate"}
{"question": "Split-adjusted close series for EW.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='EW' order by date;", "intent": "adjusted_price"}
{"question": "Monthly OHLCV for CLX in 2024-06-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CLX' and month='2024-06-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Corporate actions for NWS ordered by date.", "sql": "select * from views.corporate_actions where ticker='NWS' order by event_date;", "intent": "corporate_actions"}
{"question": "Split-adjusted close series for PODD.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='PODD' order by date;", "intent": "adjusted_price"}
{"question": "Dividend yield TTM time series for MO.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='MO' order by date;", "intent": "dividend_yield"}
{"question": "Company profile for NKE including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='NKE';", "intent": "profile"}
{"question": "Average close and total volume for sector Healthcare on 2023-11-03.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2023-11-03';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for AEP between 2025-03-10 and 2025-03-17.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='AEP' and p.date between '2025-03-10' and '2025-03-17' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Technology on 2024-03-21.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-03-21';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Communication Services on 2024-04-11.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Communication Services' and p.date='2024-04-11';", "intent": "sector_aggregate"}
{"question": "Close price and split factors for DIS between 2024-10-30 and 2024-12-16.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='DIS' and p.date between '2024-10-30' and '2024-12-16' order by p.date;", "intent": "join_splits"}
{"question": "Close price and split factors for CPT between 2025-05-01 and 2025-07-01.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CPT' and p.date between '2025-05-01' and '2025-07-01' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for CMI in 2024-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='CMI' and month='2024-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for CPT including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='CPT';", "intent": "profile"}
{"question": "Tickers in sector Industrials that traded on 2024-08-15.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-15' and t.sector='Industrials' order by 1;", "intent": "membership"}
{"question": "Average close for AME from 2025-03-19 to 2025-05-13.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='AME' and date between '2025-03-19' and '2025-05-13';", "intent": "avg_between_dates"}
{"question": "Tickers in sector Financial Services that traded on 2024-08-20.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-20' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Latest close and volume for ADI.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='ADI') select date, close, volume from core.prices_daily, mx where ticker='ADI' and date=mx.md;", "intent": "latest_point"}
{"question": "Show OHLCV for BIIB on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='BIIB') select p.* from core.prices_daily p, d where p.ticker='BIIB' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Top 10 gainers by daily return on 2024-10-11.", "sql": "with r as ( select ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where date='2024-10-11' ) select ticker, ret from r order by ret desc limit 10;", "intent": "top_k"}
{"question": "Weekly OHLCV for GEHC in week 2024-12-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='GEHC' and week='2024-12-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Weekly OHLCV for SWK in week 2025-03-17 00:00:00.", "sql": "select * from views.prices_weekly where ticker='SWK' and week='2025-03-17 00:00:00';", "intent": "resample_weekly"}
{"question": "7-day and 30-day returns for LH.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='LH' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Year-to-date cumulative return for PCAR.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='PCAR' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close for KKR from 2024-11-11 to 2024-11-25.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='KKR' and date between '2024-11-11' and '2024-11-25';", "intent": "avg_between_dates"}
{"question": "Corporate actions for MS ordered by date.", "sql": "select * from views.corporate_actions where ticker='MS' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close for J from 2024-04-08 to 2024-04-26.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='J' and date between '2024-04-08' and '2024-04-26';", "intent": "avg_between_dates"}
{"question": "Weekly OHLCV for TXT in week 2023-12-25 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TXT' and week='2023-12-25 00:00:00';", "intent": "resample_weekly"}
{"question": "Latest close and volume for EMR.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='EMR') select date, close, volume from core.prices_daily, mx where ticker='EMR' and date=mx.md;", "intent": "latest_point"}
{"question": "Average close and total volume for sector Consumer Cyclical on 2024-12-06.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Consumer Cyclical' and p.date='2024-12-06';", "intent": "sector_aggregate"}
{"question": "Corporate actions for MET ordered by date.", "sql": "select * from views.corporate_actions where ticker='MET' order by event_date;", "intent": "corporate_actions"}
{"question": "7-day and 30-day returns for PFE.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='PFE' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Latest close and volume for ADSK.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='ADSK') select date, close, volume from core.prices_daily, mx where ticker='ADSK' and date=mx.md;", "intent": "latest_point"}
{"question": "Corporate actions for CINF ordered by date.", "sql": "select * from views.corporate_actions where ticker='CINF' order by event_date;", "intent": "corporate_actions"}
{"question": "Average close and total volume for sector Technology on 2024-06-11.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Technology' and p.date='2024-06-11';", "intent": "sector_aggregate"}
{"question": "Average close and total volume for sector Industrials on 2024-11-19.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Industrials' and p.date='2024-11-19';", "intent": "sector_aggregate"}
{"question": "Average close for BXP from 2025-08-20 to 2025-08-27.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='BXP' and date between '2025-08-20' and '2025-08-27';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for AZO in 2025-10-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='AZO' and month='2025-10-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Latest close and volume for K.", "sql": "with mx as (select max(date) as md from core.prices_daily where ticker='K') select date, close, volume from core.prices_daily, mx where ticker='K' and date=mx.md;", "intent": "latest_point"}
{"question": "Show OHLCV for AKAM on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='AKAM') select p.* from core.prices_daily p, d where p.ticker='AKAM' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Company profile for LLY including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='LLY';", "intent": "profile"}
{"question": "Close price and split factors for CTVA between 2024-08-14 and 2024-11-27.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='CTVA' and p.date between '2024-08-14' and '2024-11-27' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Communication Services that traded on 2024-10-15.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-10-15' and t.sector='Communication Services' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for COR between 2025-07-11 and 2025-08-06.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='COR' and p.date between '2025-07-11' and '2025-08-06' order by p.date;", "intent": "join_dividends"}
{"question": "Tickers in sector Healthcare that traded on 2024-08-26.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-08-26' and t.sector='Healthcare' order by 1;", "intent": "membership"}
{"question": "Weekly OHLCV for CMS in week 2025-09-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='CMS' and week='2025-09-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Dividend yield TTM time series for MAS.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='MAS' order by date;", "intent": "dividend_yield"}
{"question": "Close price and split factors for HST between 2024-06-20 and 2024-06-28.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='HST' and p.date between '2024-06-20' and '2024-06-28' order by p.date;", "intent": "join_splits"}
{"question": "Average close and total volume for sector Financial Services on 2024-11-29.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Financial Services' and p.date='2024-11-29';", "intent": "sector_aggregate"}
{"question": "Tickers in sector Financial Services that traded on 2025-01-23.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-01-23' and t.sector='Financial Services' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Energy that traded on 2024-01-08.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-01-08' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "7-day and 30-day returns for CMI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='CMI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Dividend yield TTM time series for XEL.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='XEL' order by date;", "intent": "dividend_yield"}
{"question": "Dividend yield TTM time series for KO.", "sql": "select date, dividend_yield_ttm from views.dividend_yield_ttm where ticker='KO' order by date;", "intent": "dividend_yield"}
{"question": "Tickers in sector Energy that traded on 2024-07-25.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-07-25' and t.sector='Energy' order by 1;", "intent": "membership"}
{"question": "Close price and dividend cash events for DVN between 2024-01-04 and 2024-04-15.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='DVN' and p.date between '2024-01-04' and '2024-04-15' order by p.date;", "intent": "join_dividends"}
{"question": "Monthly OHLCV for MAA in 2025-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='MAA' and month='2025-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Year-to-date cumulative return for EXPD.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='EXPD' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Weekly OHLCV for TTWO in week 2025-04-14 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TTWO' and week='2025-04-14 00:00:00';", "intent": "resample_weekly"}
{"question": "Close price and dividend cash events for TPR between 2024-11-20 and 2024-12-06.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='TPR' and p.date between '2024-11-20' and '2024-12-06' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and dividend cash events for FAST between 2025-07-09 and 2025-10-07.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='FAST' and p.date between '2025-07-09' and '2025-10-07' order by p.date;", "intent": "join_dividends"}
{"question": "Average close for DD from 2025-06-09 to 2025-07-28.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='DD' and date between '2025-06-09' and '2025-07-28';", "intent": "avg_between_dates"}
{"question": "Was NYSE open on 2024-03-26?", "sql": "select is_open from core.trading_calendar where exchange='nyse' and date='2024-03-26';", "intent": "calendar_filter"}
{"question": "Average close and total volume for sector Basic Materials on 2025-07-15.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Basic Materials' and p.date='2025-07-15';", "intent": "sector_aggregate"}
{"question": "Corporate actions for SNA ordered by date.", "sql": "select * from views.corporate_actions where ticker='SNA' order by event_date;", "intent": "corporate_actions"}
{"question": "Show OHLCV for EXC on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='EXC') select p.* from core.prices_daily p, d where p.ticker='EXC' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "7-day and 30-day returns for NI.", "sql": "with base as ( select date, ticker, close from core.prices_daily where ticker='NI' ) select date, ticker, close, close/lag(close,7) over (partition by ticker order by date)-1 as r7, close/lag(close,30) over (partition by ticker order by date)-1 as r30 from base;", "intent": "delta_window"}
{"question": "Average close for ADP from 2025-06-06 to 2025-07-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='ADP' and date between '2025-06-06' and '2025-07-21';", "intent": "avg_between_dates"}
{"question": "Monthly OHLCV for ENPH in 2024-01-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ENPH' and month='2024-01-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Split-adjusted close series for CVS.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='CVS' order by date;", "intent": "adjusted_price"}
{"question": "Close price and dividend cash events for FSLR between 2025-04-14 and 2025-06-26.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='FSLR' and p.date between '2025-04-14' and '2025-06-26' order by p.date;", "intent": "join_dividends"}
{"question": "Weekly OHLCV for TSCO in week 2024-04-22 00:00:00.", "sql": "select * from views.prices_weekly where ticker='TSCO' and week='2024-04-22 00:00:00';", "intent": "resample_weekly"}
{"question": "Monthly OHLCV for TROW in 2024-09-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='TROW' and month='2024-09-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Close price and split factors for PANW between 2024-03-28 and 2024-04-08.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='PANW' and p.date between '2024-03-28' and '2024-04-08' order by p.date;", "intent": "join_splits"}
{"question": "Tickers in sector Real Estate that traded on 2024-11-12.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-11-12' and t.sector='Real Estate' order by 1;", "intent": "membership"}
{"question": "Tickers in sector Basic Materials that traded on 2024-02-29.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2024-02-29' and t.sector='Basic Materials' order by 1;", "intent": "membership"}
{"question": "Close price and split factors for AEP between 2025-02-05 and 2025-02-25.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='AEP' and p.date between '2025-02-05' and '2025-02-25' order by p.date;", "intent": "join_splits"}
{"question": "Monthly OHLCV for ADSK in 2024-02-01 00:00:00.", "sql": "select * from views.prices_monthly where ticker='ADSK' and month='2024-02-01 00:00:00';", "intent": "resample_monthly"}
{"question": "Company profile for A including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='A';", "intent": "profile"}
{"question": "Close price and dividend cash events for TECH between 2025-01-08 and 2025-03-17.", "sql": "select p.date, p.close, coalesce(d.cash_amount, 0) as cash_amount from core.prices_daily p left join core.dividends d on d.ticker=p.ticker and d.event_date=p.date where p.ticker='TECH' and p.date between '2025-01-08' and '2025-03-17' order by p.date;", "intent": "join_dividends"}
{"question": "Close price and split factors for KR between 2024-05-23 and 2024-06-06.", "sql": "select p.date, p.close, case when s.split_from>0 and s.split_to>0 then s.split_from/s.split_to else null end as split_factor from core.prices_daily p left join core.splits s on s.ticker=p.ticker and s.event_date=p.date where p.ticker='KR' and p.date between '2024-05-23' and '2024-06-06' order by p.date;", "intent": "join_splits"}
{"question": "Split-adjusted close series for BXP.", "sql": "select date, close_adj_splits from views.adjusted_prices_splits where ticker='BXP' order by date;", "intent": "adjusted_price"}
{"question": "Show OHLCV for WDC on its first trading day.", "sql": "with d as (select min(date) as d0 from core.prices_daily where ticker='WDC') select p.* from core.prices_daily p, d where p.ticker='WDC' and p.date=d.d0;", "intent": "point_lookup"}
{"question": "Company profile for MDLZ including sector and exchange.", "sql": "select t.ticker, t.name, t.sector, t.exchange, r.company_name, r.industry, r.market, r.primary_exchange from core.tickers t left join core.ref_tickers r using (ticker) where t.ticker='MDLZ';", "intent": "profile"}
{"question": "Tickers in sector Technology that traded on 2025-08-29.", "sql": "select distinct p.ticker from core.prices_daily p join core.tickers t using (ticker) where p.date='2025-08-29' and t.sector='Technology' order by 1;", "intent": "membership"}
{"question": "Average close and total volume for sector Real Estate on 2025-03-14.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Real Estate' and p.date='2025-03-14';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for DHR in week 2023-10-23 00:00:00.", "sql": "select * from views.prices_weekly where ticker='DHR' and week='2023-10-23 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for AKAM.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='AKAM' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close for GOOG from 2025-03-12 to 2025-03-21.", "sql": "select avg(close) as avg_close from core.prices_daily where ticker='GOOG' and date between '2025-03-12' and '2025-03-21';", "intent": "avg_between_dates"}
{"question": "Average close and total volume for sector Energy on 2024-11-04.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Energy' and p.date='2024-11-04';", "intent": "sector_aggregate"}
{"question": "Weekly OHLCV for STE in week 2024-07-15 00:00:00.", "sql": "select * from views.prices_weekly where ticker='STE' and week='2024-07-15 00:00:00';", "intent": "resample_weekly"}
{"question": "Year-to-date cumulative return for HRL.", "sql": "with dr as ( select date, ticker, close/lag(close) over (partition by ticker order by date)-1 as ret from core.prices_daily where ticker='HRL' ), with_y as ( select date, ticker, ret, date_trunc('year', date) as y from dr ), agg as ( select date, ticker, exp(sum(ln(1+ret)) over (partition by ticker, y order by date rows between unbounded preceding and current row))-1 as cum_ret_ytd from with_y ) select date, cum_ret_ytd from agg order by date;", "intent": "ytd"}
{"question": "Average close and total volume for sector Healthcare on 2024-10-30.", "sql": "select avg(p.close) as avg_close, sum(p.volume) as total_volume from core.prices_daily p join core.tickers t using (ticker) where t.sector='Healthcare' and p.date='2024-10-30';", "intent": "sector_aggregate"}
